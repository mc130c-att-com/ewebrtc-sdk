/*! ewebrtc-sdk_26-09-2014 */
function trace(a){"\n"===a[a.length-1]&&(a=a.substring(0,a.length-1)),console.log((performance.now()/1e3).toFixed(3)+": "+a)}if(function(){"use strict";var a={"private":{factories:{},config:{}},utils:{},logManager:{},RESTClient:{},rtc:{}};window.ATT=a}(),!ATT)var ATT={};if(function(a){"use strict";function b(a){var b={},c=[],d=b;return a.split("\r\n").filter(k).forEach(function(a){var b=a[0],e=a.slice(2);"m"===b&&(c.push({rtp:[],fmtp:[]}),d=c[c.length-1]);for(var f=0;f<(g[b]||[]).length;f+=1){var h=g[b][f];if(h.reg.test(e))return j(h,d,e)}}),b.media=c,b}function c(a,b){b=b||{},null==a.version&&(a.version=0),null==a.name&&(a.name=" "),a.media.forEach(function(a){null==a.payloads&&(a.payloads="")});var c=b.outerOrder||o,d=b.innerOrder||p,e=[];return c.forEach(function(b){g[b].forEach(function(c){c.name in a?e.push(n(b,c,a)):c.push in a&&a[c.push].forEach(function(a){e.push(n(b,c,a))})})}),a.media.forEach(function(a){e.push(n("m",g.m[0],a)),d.forEach(function(b){g[b].forEach(function(c){c.name in a?e.push(n(b,c,a)):c.push in a&&a[c.push].forEach(function(a){e.push(n(b,c,a))})})})}),e.join("\r\n")+"\r\n"}var d,e,f={},g={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w\/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-]*)\/(\d*)(?:\s*\/(\S*))?/,names:["payload","codec","rate","encoding"],format:function(a){return a.encoding?"rtpmap:%d %s/%s/%s":"rtpmap:%d %s/%s"}},{push:"fmtp",reg:/^fmtp:(\d*) (\S*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(a){return null!=a.address?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%d trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(a){return null!=a.subtype?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:([\w_\/]*) (\S*)(?: (\S*))?/,names:["value","uri","config"],format:function(a){return null!=a.config?"extmap:%s %s %s":"extmap:%s %s"}},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(a){return null!=a.sessionConfig?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"mid",reg:/^mid:(\w*)/,format:"mid:%s"},{name:"ptime",reg:/^ptime:(\d*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/,format:"%s"},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: generation (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","generation"],format:function(a){var b="candidate:%s %d %s %d %s %d typ %s";return b+=null!=a.raddr?" raddr %s rport %d":"%v%v",null!=a.generation&&(b+=" generation %d"),b}},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_]*):(.*)/,names:["id","attribute","value"],format:"ssrc:%d %s:%s"},{name:"msidSemantic",reg:/^msid-semantic: (\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{push:"invalid",names:["value"]}]};Object.keys(g).forEach(function(a){var b=g[a];b.forEach(function(a){a.reg||(a.reg=/(.*)/),a.format||(a.format="%s")})});var h=function(a){return String(Number(a))===a?Number(a):a},i=function(a,b,c,d){if(d&&!c)b[d]=h(a[1]);else for(var e=0;e<c.length;e+=1)null!=a[e+1]&&(b[c[e]]=h(a[e+1]))},j=function(a,b,c){var d=a.name&&a.names;a.push&&!b[a.push]?b[a.push]=[]:d&&!b[a.name]&&(b[a.name]={});var e=a.push?{}:d?b[a.name]:b;i(c.match(a.reg),e,a.names,a.name),a.push&&b[a.push].push(e)},k=RegExp.prototype.test.bind(/^([a-z])=(.*)/),l=/%[sdv%]/g,m=function(a){var b=1,c=arguments,d=c.length;return a.replace(l,function(a){if(b>=d)return a;var e=c[b];switch(b+=1,a){case"%%":return"%";case"%s":return String(e);case"%d":return Number(e);case"%v":return""}})},n=function(a,b,c){var d=b.format instanceof Function?b.format(b.push?c:c[b.name]):b.format,e=[a+"="+d];if(b.names)for(var f=0;f<b.names.length;f+=1){var g=b.names[f];e.push(b.name?c[b.name][g]:c[b.names[f]])}else e.push(c[b.name]);return m.apply(null,e)},o=["v","o","s","i","u","e","p","c","b","t","r","z","a"],p=["i","c","b","a"];e=function(){return{parse:function(a){return b(a)},write:function(a){return c(a)}}},a.sdpParser=f,f.getInstance=function(){return d||(d=e()),d}}(ATT||{}),function(){"use strict";function a(a,b,c){"object"==typeof b?console.log(a,b,"["+k()+"]"):(console.log(a+" "+b+" ["+k()+"]"),c&&console.log(c))}function b(b){var c=b.level,d=b.type;return{type:function(){return d},level:function(){return c},logInfo:function(b){void 0!==b&&0!==b.length&&c>=l.LOG_LEVEL.INFO&&a("[INFO]",b)},logDebug:function(b){void 0!==b&&0!==b.length&&c>=l.LOG_LEVEL.DEBUG&&a("[DEBUG]",b)},logWarning:function(b){void 0!==b&&0!==b.length&&c>=l.LOG_LEVEL.WARNING&&a("[WARN]",b)},logError:function(b){void 0!==b&&0!==b.length&&c>=l.LOG_LEVEL.ERROR&&a("[ERROR]",b)},logTrace:function(b,d){void 0!==b&&0!==b.length&&c>=l.LOG_LEVEL.TRACE&&a("[TRACE]",b,d)},setLevel:function(a){c=a},setType:function(a){d=a}}}function c(a,c,d){var e=m[a];if(!e)return c===l.LOGGER_TYPE.CONSOLE&&(e=b({level:d,type:c})),m[a]=e,!0}function d(a,c,d){var e=c||l.LOGGER_TYPE.CONSOLE,f=d||l.LOG_LEVEL.INFO,g=m[a];return g||e===l.LOGGER_TYPE.CONSOLE&&(g=b({level:f,type:e}),m[a]=g),g}function e(a){var b,c=ATT.logManager.getInstance();return c.configureLogger(a,c.loggerType.CONSOLE,c.logLevel.INFO),b=c.getLogger(a),n[a]=b,n[a]}function f(a){var b=n[a];return void 0===b?e(a):b}function g(a,b){var c=d(a);c||c.setLevel(b)}function h(){return{getLogger:d,configureLogger:c,loggerType:l.LOGGER_TYPE,logLevel:l.LOG_LEVEL,getLoggerByName:f,addLoggerForModule:e,updateLogLevel:g}}var i,j,k,l={},m=[],n=[];l.LOGGER_TYPE={CONSOLE:"Console",FILE:"File"},l.LOG_LEVEL={ERROR:0,WARNING:1,INFO:2,DEBUG:3,TRACE:4},k=function(){var a,b="",c="",d=[],e="",f=[];try{throw new Error}catch(g){return c=g.stack.split("\n")[4],d=c.split(":"),e=d[2],f=e.split("/"),b=f[f.length-1],b.indexOf("?")>-1&&(b=b.split("?")[0]),a=d[3],b+":"+a}},l.getInstance=function(){return j||(j=h()),j},"object"==typeof module&&module&&"object"==typeof module.exports&&(module.exports=l),i=typeof window,"undefined"!==i&&ATT&&(ATT.logManager=l)}(),function(){"use strict";function a(){function a(a,b){a.callback.apply(a.context,b)}var b={};return{getTopics:function(){return b},unsubscribe:function(a,c){var d,e;if(!b.hasOwnProperty(a))return!1;if("function"!=typeof c)throw new Error("Must pass in the callback you are unsubscribing");for(e=b[a],d=0;d<e.length;d+=1)if(e[d].callback===c)return e.splice(d,1),0===e.length&&delete b[a],!0;return!1},publish:function(){var c,d,e=Array.prototype.slice.call(arguments),f=e.shift();if(!b.hasOwnProperty(f))return!1;for(d=b[f],c=0;c<d.length;c+=1)setTimeout(a.bind(null,b[f][c],e),0);return!0},subscribe:function(a,c,d){var e,f;if(""===a||null===a||void 0===a)return!1;if("function"!=typeof c)return!1;if(void 0!==d&&(null===d||"object"!=typeof d))return!1;var g={context:d,callback:c};for(b.hasOwnProperty(a)||(b[a]=[]),e=b[a],f=0;f<e.length;f+=1)if(c===e[f].callback)return!1;return b[a].push(g),!0}}}var b;b=typeof window.ATT,void 0===b?window.ATT={"private":{factories:{}}}:void 0===ATT.private&&(ATT.private={factories:{}}),ATT.private.factories.createEventEmitter=a}(),!ATT)var ATT={};var attUtils=null;"object"==typeof module&&module&&"object"==typeof module.exports&&(attUtils={utils:require("./att.utils"),logManager:require("./att.log-manager.js")},module.exports=attUtils);var RESTClient=function(a){"use strict";function b(b){b.forEach(function(b){m.prototype[b]=function(c){c.method=b,c.headers=i(a).extend(this.config.headers,c.headers),this.ajax(c)}})}var c,d,e=typeof window,f="object"==typeof module&&module&&"object"==typeof module.exports,g=null,h={"Content-Type":"application/json",Accept:"application/json"},i=function(a){return f?attUtils.utils.utils:a.utils},j=function(a){g=a},k=function(a){return f?attUtils.logManager.getInstance():a.logManager.getInstance()},l=k(a),m=function(b){l.configureLogger("RESTClient",l.loggerType.CONSOLE,l.logLevel.DEBUG),g=l.getLogger("RESTClient"),this.config=i(a).extend({},b),this.config.async=this.config.async||!0,this.config.timeout=this.config.timeout||3e4,this.config.success=this.config.success||function(){},this.config.error=this.config.error||c,this.config.ontimeout=this.config.ontimeout||function(a){g.logDebug(a),g.logError("Request timed out")},this.config.headers=this.config.headers||h},n=function(a,b,c,d){var e,f,g=JSON.stringify(d);try{e=l.getLogger("RESTClient")}catch(h){console.log("Unable to configure request logger"+h)}e.logDebug("---------Request---------------"),e.logDebug(a+" "+b+" HTTP/1.1"),e.logDebug("=========headers=======");for(f in c)c.hasOwnProperty(f)&&e.logDebug(f+": "+c[f]);void 0!==g&&(e.logDebug("=========body=========="),e.logDebug(g))},o=function(a){var b;try{b=l.getLogger("RESTClient")}catch(c){console.log("Unable to configure default logger"+c)}b.logDebug("---------Response--------------"),b.logDebug(a.getResponseStatus()),b.logDebug("=========headers======="),b.logDebug(a.headers),b.logDebug("=========body=========="),b.logDebug(a.responseText)},p=function(a){var b,c=a.getResponseHeader("Content-Type");return c&&0===c.indexOf("application/json")?(b=JSON.parse(a.responseText),"object"==typeof b?b:JSON.parse(b)):""},q=function(a,b){var c={getJson:function(){return p(a)},getResponseHeader:function(b){return a.getResponseHeader(b)},responseText:a.responseText,headers:a.getAllResponseHeaders(),statusText:a.statusText,getResponseStatus:function(){return a.status},getResourceURL:function(){return b.method.toUpperCase()+" "+b.url}};return c},r=function(b){var e=this,f=q(e,b),g=i(a).extend({},f);o(g),e.status>=400&&e.status<=599?"function"==typeof d?d.call(e,g):c.call(e,g):b.success.call(e,g)},s=function(b){var c=this,d=q(c,b),e=i(a).extend({},d);o(e),b.error.call(this,e)},t=function(b){var c=this,d=q(c,b),e=i(a).extend({},d);o(e),g.logError("Request timeout"),b.ontimeout.call(this,e)};return m.prototype.ajax=function(){var a=this.config,b=new XMLHttpRequest,e=null,f=null,h=null;try{e=a.data&&JSON.stringify(a.data),g||(console.log("Using console logger for debugging"),j(null)),b.timeout=a.timeout,b.onload=r.bind(b,a),d=a.error,b.onerror=function(){if("undefined"===a.error)throw new Error("Network error occurred in REST client.");s.call(this,a)},b.onreadystatechange=function(){4===this.readyState&&0===this.status&&""===this.statusText&&void 0===a.ontimeout&&(g.logError("Failed to complete request for resource:"+a.url),s.call(this,a))},b.onabort=s.bind(b,a),b.ontimeout=t.bind(b,a),b.open(a.method,a.url,a.async);for(f in a.headers)a.headers.hasOwnProperty(f)&&b.setRequestHeader(f,a.headers[f]);n(a.method,a.url,a.headers,e),b.send(e)}catch(i){h=l.getLogger("RESTClient"),h.logError("XHR request failed, "+i),"function"==typeof d?d.call(b,i):c.call(b,i)}},c=function(a){throw new Error("RESTClient error handler triggered!"+a)},b(["get","post","delete"]),m.prototype.getConfig=function(){return this.config},"undefined"!==e&&ATT&&(ATT.RESTClient=m),m}(ATT);"object"==typeof module&&module&&"object"==typeof module.exports&&(module.exports=RESTClient);var attUtils=function(a){"use strict";function b(a){return null===a.match(new RegExp("[^0-9]"))?10===a.length?"tel:+1"+a:0===a.indexOf("1")?"tel:+"+a:0===a.indexOf("+")?"tel:"+a:"sip:"+a+"@icmn.api.att.net":a.indexOf("@")>0?"sip:"+a:null}var c=function(a,b){var d;for(d in b)b.hasOwnProperty(d)&&(a[d]=b[d]instanceof Object?c(b[d]):b[d]);return a},d=function(a,b){a.super=b,a.prototype=Object.create(b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}})},e=function(a,b){var c=b.split("."),d=a;return c.forEach(function(a){d[a]||(d[a]={}),d=d[a]}),d};a.utils={createNamespace:e,extend:c,inherits:d,createCalledPartyUri:b},"object"==typeof module&&module&&"object"==typeof module.exports&&(module.exports=a)}(ATT);if(!ATT)var ATT={};if(function(a){"use strict";function b(a){var b,c,d,e,f,g;for(c="m=video.*",b=a.split("\r\n"),d=[],f=0;f<b.length&&!b[f].match(c);f+=1)d.push(b[f]);e=["m=video 18396 RTP/SAVPF 100 116 117","a=inactive","a=rtpmap:100 VP8/90000","a=rtcp-fb:100 ccm fir","a=rtcp-fb:100 nack","a=rtcp-fb:100 nack pli","a=rtcp-fb:100 goog-remb","a=rtpmap:116 red/90000","a=rtpmap:117 ulpfec/90000","a=fingerprint:SHA-1 47:A7:77:D5:12:9E:B3:EF:BB:E8:B2:FA:17:49:C8:61:D3:9C:3E:7E","a=setup:active","a=candidate:1 1 UDP 2130706431 12.102.196.108 18396 typ host","a=candidate:1 2 UDP 2130706430 12.102.196.108 18397 typ host","a=rtcp:18397","a=ice-ufrag:ZovN","a=ice-pwd:XZ4FRPpHtkdmQ59aGGfcRMGf",""];for(g in e)e.hasOwnProperty(g)&&d.push(e[g]);return d.join("\r\n")}function c(a,b){var c="a="+a+"\r\n",d=b.indexOf(c);return d>0&&(b=b.replace(c,"")),b}function d(a,b){n.logTrace("increment sdp",a),n.logTrace("increment count",b);var c,d=a.sdp.indexOf("o="),e=a.sdp.indexOf("s=-"),f=a.sdp.slice(d,e),g=f.split(" ");return c=f.replace(" "+g[2].toString()+" "," "+b.toString()+" "),a.sdp=a.sdp.replace(f,c),n.logTrace("modified sdp",a),a}function e(a){var b,c,d=[],e=ATT.sdpParser.getInstance().parse(a);for(n.logDebug("Parsed SDP "+e),b=0;b<e.media.length;b+=1)c={rtp:e.media[b].rtp,type:e.media[b].type},d.push(c);return d}function f(a){return a=a.replace(/a=mid:video\r\n/g,""),a=a.replace(/a=mid:audio\r\n/g,""),a=a.replace(/a=group:BUNDLE audio video\r\n/g,""),a=a.replace(/a=group:BUNDLE audio\r\n/g,"")}function g(a){return-1!==a.indexOf("setup:passive")?a=a.replace(/setup:passive/g,"setup:actpass"):-1!==a.indexOf("setup:active")&&(a=a.replace(/setup:active/g,"setup:actpass")),a}function h(a){return navigator.mozGetUserMedia?(a=a.replace("RTP/SAVPF 109 0","RTP/SAVPF 0"),a=a.replace("\r\na=rtpmap:109 opus/48000/2","")):(a=a.replace("RTP/SAVPF 111 103 104 0 ","RTP/SAVPF 0 "),a=a.replace("\r\na=rtpmap:111 opus/48000/2",""),a=a.replace("\r\na=rtpmap:103 ISAC/16000",""),a=a.replace("\r\na=rtpmap:104 ISAC/32000",""),a=a.replace("\r\na=fmtp:111 minptime=10","")),a}function i(){q+=1}function j(a){if(n.logDebug("sdpFilter.modifyForHoldCall"),void 0===a)throw n.logError("Please pass the correct parameter for modifyForHoldCall"),new Error("parameter `localSdp` is undefined");try{var b=a;return b.sdp=b.sdp.replace(/a=sendrecv/g,"a=recvonly"),b.sdp=b.sdp.replace(/a=sendonly/g,"a=recvonly"),b.type="offer",b=this.processChromeSDPOffer(b),i(),b=d(b,q)}catch(c){throw c}}function k(a){if(n.logDebug("sdpFilter.modifyForResumeCall"),void 0===a)throw n.logError("Please pass the correct parameter for modifyForResumeCall"),new Error("parameter `localSdp` is undefined");try{var b=a;return b.sdp=b.sdp.replace(/a=recvonly/g,"a=sendrecv"),b.sdp=b.sdp.replace(/a=sendonly/g,"a=sendrecv"),b.type="offer",b=this.processChromeSDPOffer(b),i(),b=d(b,q)}catch(c){throw c}}var l,m,n,o={},p=ATT.logManager.getInstance(),q=2;n=p.getLoggerByName("SDPFilterModule"),m=function(){return{processChromeSDPOffer:function(a){return a.sdp=f(a.sdp),a.sdp=h(a.sdp),i(),a=d(a,q)},incrementSDP:function(a,b){return d(a,b)},removeSDPAttribute:function(a,b){return c(a,b)},getCodecfromSDP:function(a){return e(a)},setupActivePassive:g,modifyForHoldCall:j,modifyForResumeCall:k,fakeVideo:b}},a.sdpFilter=o,o.getInstance=function(){return l||(l=m()),l}}(ATT||{}),function(a){"use strict";var b=a.logManager.getInstance(),c=b.getLoggerByName("RTCManager"),d={alphaLookup:{a:2,b:2,c:2,d:3,e:3,f:3,g:4,h:4,i:4,j:5,k:5,l:5,m:6,n:6,o:6,p:7,q:7,r:7,s:7,t:8,u:8,v:8,w:9,x:9,y:9,z:9},stringify:function(a){var b,c=d.translate(a),e=c.length,f="1"===c.charAt(0),g=c.split("");return e>(f?11:10)?c:!f&&4>e?c:(f&&g.splice(0,1),f?e>1&&(b=4-e,b=b>0?b:0,g.splice(0,0," ("),g.splice(4,0,new Array(b+1).join(" ")+") "),e>7&&g.splice(8,0,"-")):e>7?(g.splice(0,0,"("),g.splice(4,0,") "),g.splice(8,0,"-")):e>3&&g.splice(3,0,"-"),(f?"+1":"")+g.join(""))},translate:function(a){var b,c,e="";for(b=0;b<a.length;b+=1)c=a.charAt(b),isNaN(c)?void 0!==d.alphaLookup[c.toLowerCase()]&&(e+=d.alphaLookup[c.toLowerCase()]):e+=c;return e.length>=11&&"1"===e.charAt(0)?e=e.substring(0,11):e.length>=11&&"1"!==e.charAt(0)&&(e=e.substring(0,10)),String(e)},getCallable:function(a,b){var c=b||"us",e=d.translate(a);return 10!==e.length?"us"===c&&11===e.length&&"1"===e.charAt(0)?e:!1:"us"===c?"1"+e:void 0},cleanPhoneNumber:function(b){var d,e;try{return-1!==b.indexOf("@")?b:(d=b.replace(/\s/g,""),-1!==d.indexOf("sip:")||-1!==d.indexOf("tel:")?!1:a.SpecialNumbers[b]?b:(d=a.phoneNumber.getCallable(d))?d:(c.logWarning("Phone number not callable, will check special numbers list."),c.logInfo("checking number: "+d),e=a.phoneNumber.translate(b),console.log("ATT.SpecialNumbers["+e+"] = "+e),!1))}catch(f){throw c.logError(f),a.errorDictionary.getSDKError(26001)}},formatNumber:function(b){try{var d=this.cleanPhoneNumber(b);return d?b.length<=10?d:(c.logInfo("The formated Number"+d),a.phoneNumber.stringify(d)):void c.logWarning("Phone number not formatable .")}catch(e){throw c.logError(e),a.errorDictionary.getSDKError(26001)}}};a.phoneNumber=d}(ATT),!ATT)var ATT={};if(function(a){"use strict";var b={};b.SpecialNumbers={911:!0,411:!0,611:!0,"*69":!0,"#89":!0},a.SpecialNumbers=Object.freeze(b.SpecialNumbers)}(ATT||{}),function(){"use strict";var a,b,c,d={};if(a={MOBILE_NUMBER:"MOBILE_NUMBER",VIRTUAL_NUMBER:"VIRTUAL_NUMBER",ACCOUNT_ID:"ACCOUNT_ID"},b={OUTGOING:"Outgoing",INCOMING:"Incoming"},c={INVITATION_RECEIVED:"invitation-received",SESSION_OPEN:"session-open",SESSION_MODIFIED:"session-modified",SESSION_TERMINATED:"session-terminated",MODIFICATION_RECEIVED:"mod-received",MODIFICATION_TERMINATED:"mod-terminated"},void 0===ATT.private)throw new Error("Error exporting ATT.private.enum");d.USER_TYPE=Object.freeze(a),d.CALL_TYPE=Object.freeze(b),d.API_EVENT=Object.freeze(c),ATT.private.enum=d}(),!ATT)var ATT={};!function(){"use strict";function a(a){var b={dhs_https_url:a.dhs_https_url,rtc_endpoint:a.api_endpoint+a.ewebrtc_uri,headers:{"Content-Type":"application/json",Accept:"application/json"}};return{registerUser:{method:"POST",url:b.dhs_https_url+"/users",headers:b.headers},deleteUser:{method:"DELETE",formatters:{url:function(a){return b.dhs_https_url+"/users/"+a}},headers:b.headers},oAuthToken:{method:"POST",url:b.dhs_https_url+"/tokens",headers:b.headers},authenticateUser:{method:"POST",url:b.dhs_https_url+"/user/session",headers:b.headers},logoutUser:{method:"DELETE",url:b.dhs_https_url+"/user/session",headers:b.headers},createE911Id:{method:"POST",url:b.dhs_https_url+"/e911ids",headers:b.headers},associateTokenWithUserId:{method:"PUT",formatters:{url:function(a){return b.rtc_endpoint+"/userIds/"+a.userId},headers:{Authorization:function(a){return"Bearer "+a}}},headers:{Accept:"application/json"}},createWebRTCSession:{method:"POST",url:b.rtc_endpoint+"/sessions",formatters:{headers:{Authorization:function(a){return"Bearer "+a},"x-e911Id":function(a){return a},"x-Arg":function(a){return a}}},headers:b.headers},refreshWebRTCSession:{method:"PUT",formatters:{url:function(a){return b.rtc_endpoint+"/sessions/"+a},headers:{Authorization:function(a){return"Bearer "+a}}},headers:b.headers},deleteWebRTCSession:{method:"DELETE",formatters:{url:function(a){return b.rtc_endpoint+"/sessions/"+a},headers:{Authorization:function(a){return"Bearer "+a},"x-e911Id":function(a){return a}}},headers:b.headers},associateE911Id:{method:"PUT",formatters:{url:function(a){return b.rtc_endpoint+"/sessions/"+a},headers:{Authorization:function(a){return"Bearer "+a}}},headers:b.headers},getEvents:{formatters:{method:"GET",url:function(a){return b.rtc_endpoint+"/sessions/"+a.sessionId+"/"+a.eventChannelUri},headers:{Authorization:function(a){return"Bearer "+a}}},timeout:3e4,headers:{Accept:"application/json"}},createCall:{method:"POST",formatters:{url:function(a){return b.rtc_endpoint+"/sessions/"+a.sessionId+"/"+a.type},headers:{Authorization:function(a){return"Bearer "+a}}},headers:b.headers},modifyCall:{method:"PUT",formatters:{url:function(a){return b.rtc_endpoint+"/sessions/"+a.sessionId+"/"+a.type+"/"+a.callId},headers:{Authorization:function(a){return"Bearer "+a},options:{"x-conference-action":function(a){return a},"x-calls-action":function(a){return a}}}},headers:b.headers},addParticipant:{method:"PUT",formatters:{url:function(a){return b.rtc_endpoint+"/sessions/"+a[0]+"/conferences/"+a[1]+"/participants/"+a[2]},headers:{Authorization:function(a){return"Bearer "+a}}},headers:b.headers},removeParticipant:{method:"DELETE",formatters:{url:function(a){return b.rtc_endpoint+"/sessions/"+a[0]+"/conferences/"+a[1]+"/participants/"+a[2]},headers:{Authorization:function(a){return"Bearer "+a}}},headers:b.headers},acceptCallModifications:{method:"PUT",formatters:{url:function(a){return b.rtc_endpoint+"/sessions/"+a.sessionId+"/"+a.type+"/"+a.callId},headers:{Authorization:function(a){return"Bearer "+a},"x-modId":function(a){return a}}},headers:ATT.utils.extend({"x-calls-action":"accept-call-mod"},b.headers)},acceptConferenceModifications:{method:"PUT",formatters:{url:function(a){return b.rtc_endpoint+"/sessions/"+a.sessionId+"/"+a.type+"/"+a.callId},headers:{Authorization:function(a){return"Bearer "+a},"x-mod-Id":function(a){return a}}},headers:ATT.utils.extend({"x-conference-action":"accept-media-mod"},b.headers)},deleteCall:{method:"DELETE",formatters:{url:function(a){return b.rtc_endpoint+"/sessions/"+a.sessionId+"/"+a.type+"/"+a.callId},headers:{Authorization:function(a){return"Bearer "+a},"x-delete-reason":function(a){return a}}},headers:b.headers},transferCall:{method:"PUT",formatters:{url:function(a){return b.rtc_endpoint+"/sessions/"+a.sessionId+"/"+a.type+"/"+a.callId},headers:{Authorization:function(a){return"Bearer "+a},"x-transferTargetCallId":function(a){return a}}},headers:ATT.utils.extend({"x-calls-action":"initiate-call-transfer"},b.headers)}}}function b(){var b=c.app.getAppConfiguration();return a(b)}var c;if(void 0===ATT.private||void 0===ATT.private.config)throw new Error("Error exporting ATT.private.config.api");c=ATT.private.config,ATT.private.config.api={getAPIConfiguration:b}}(),function(){"use strict";function a(a){d=a.dhs_https_url,e=a.api_endpoint||e,f=a.ewebrtc_uri||f,g=a.ewebrtc_domain}function b(){return c={api_endpoint:e,dhs_https_url:d,ewebrtc_uri:f,ewebrtc_domain:g,eventChannelType:i}}var c,d="",e="https://api.att.com",f="/RTC/v1",g="",h={WebSockets:"WebSockets",LongPolling:"LongPolling"},i=h.LongPolling;if(void 0===ATT.private||void 0===ATT.private.config)throw new Error("Error exporting ATT.private.config.app");ATT.private.config.app={getAppConfiguration:b,setAppConfiguration:a}}(),function(){"use strict";function a(a){return Object.freeze(a),a}var b=[{JSObject:"ATT.rtc",JSMethod:"*",ErrorCode:"0000",ErrorMessage:"Error Code is not defined in error dictionary",Cause:"Error Code is not defined in error dictionary",Resolution:"Add the error object in error dictionary"},{JSObject:"ATT.rtc",JSMethod:"configure",ErrorCode:"0001",ErrorMessage:"Unable to configure the endpoint for SDK. Please ensure that correct config key is used to configure the endpoint",Cause:"Configuration key is not found",Resolution:"Please check appConfig module for correct config key"},{JSObject:"ATT.rtc",JSMethod:"*",ErrorCode:"0002",ErrorMessage:"Unable to perform requested operation. Please ensure that the application is hosted on the provisioned domain.",Cause:"CORS configuration",Resolution:"Please ensure that the application is hosted on the provisioned domain"},{JSObject:"ATT.rtc",JSMethod:"*",ErrorCode:"0003",ErrorMessage:"Request timed out",Cause:"Network failure",Resolution:"Please check the logs, check the network connectivity and try again"},{JSObject:"ATT.rtc",JSMethod:"Phone",ErrorCode:"1000",ErrorMessage:"Missing input parameter",Cause:"One or more of the input parameters are empty",Resolution:"Please check the values for input parameters"},{JSObject:"ATT.rtc",JSMethod:"Phone",ErrorCode:"1001",ErrorMessage:"Missing local video stream",Cause:"Input parameter localVideoElementID is missing",Resolution:"Please check the values for localVideoElementID"},{JSObject:"ATT.rtc",JSMethod:"Phone",ErrorCode:"1002",ErrorMessage:"Missing remote video stream",Cause:"Input parameter remoteVideoElementID is missing",Resolution:"Please check the values for remoteVideoElementID"},{JSObject:"ATT.rtc",JSMethod:"Phone",ErrorCode:"1003",ErrorMessage:"Invalid media type",Cause:"Invalid media constraints",Resolution:"Please provide use valid Media constraints attributes"},{JSObject:"ATT.rtc",JSMethod:"Phone",ErrorCode:"1004",ErrorMessage:"Internal error occurred",Cause:"Uncaught error",Resolution:"Please check the logs and contact support if needed"},{JSObject:"ATT.rtc",JSMethod:"login",ErrorCode:"2000",ErrorMessage:"Invalid user type",Cause:"Unsupported user type",Resolution:"Supported user types are Mobile Number, Virtual Number, Account ID"},{JSObject:"ATT.rtc",JSMethod:"login",ErrorCode:"2001",ErrorMessage:"Missing input parameter",Cause:"Access token & E911 ID is required",Resolution:"User type, Access token, E911 ID are mandatory fields for Mobile Number & Virtual Number user types"},{JSObject:"ATT.rtc",JSMethod:"login",ErrorCode:"2002",ErrorMessage:"Mandatory fields can not be empty",Cause:"One of the Mandatory Parameters is empty",Resolution:"Please check the values for input parameters"},{JSObject:"ATT.rtc",JSMethod:"login",ErrorCode:"2003",ErrorMessage:"Invalid input parameter",Cause:"Invalid parameter",Resolution:"For Account ID users E911 is not required"},{JSObject:"ATT.rtc",JSMethod:"login",ErrorCode:"2004",ErrorMessage:"Internal error occurred",Cause:"Uncaught error",Resolution:"Please check the logs and contact support if needed"},{JSObject:"ATT.rtc",JSMethod:"login",ErrorCode:"2005",ErrorMessage:"User already logged in",Cause:"Duplicate operation",Resolution:"Login should be called only once per session"},{JSObject:"ATT.rtc",JSMethod:"logout",ErrorCode:"3000",ErrorMessage:"Internal error occurred",Cause:"Uncaught error",Resolution:"Please check the logs and contact support if needed"},{JSObject:"ATT.rtc",JSMethod:"logout",ErrorCode:"3001",ErrorMessage:"User is not logged in",Cause:"Invalid Logout operation",Resolution:"None"},{JSObject:"ATT.rtc",JSMethod:"logout",ErrorCode:"3002",ErrorMessage:"User already logged out",Cause:"Duplicate operation",Resolution:"Logout should be called only once per session"},{JSObject:"ATT.rtc.Phone",JSMethod:"dial",ErrorCode:"4000",ErrorMessage:"Invalid input parameter",Cause:"Invalid phone number",Resolution:"Please provide a valid phone number"},{JSObject:"ATT.rtc.Phone",JSMethod:"dial",ErrorCode:"4001",ErrorMessage:"Invalid input parameter",Cause:"Invalid SIP URI",Resolution:"Please provide valid SIP URI"},{JSObject:"ATT.rtc.Phone",JSMethod:"dial",ErrorCode:"4002",ErrorMessage:"Invalid media type",Cause:"Invalid media constraints",Resolution:"Please provide use valid Media constraints attributes"},{JSObject:"ATT.rtc.Phone",JSMethod:"dial",ErrorCode:"4003",ErrorMessage:"Internal error occurred",Cause:"Uncaught error",Resolution:"Please check the logs and contact support if needed"},{JSObject:"ATT.rtc.Phone",JSMethod:"dial",ErrorCode:"4004",ErrorMessage:"User is not logged in",Cause:"Invalid operation",Resolution:"Please login first before invoking dial"},{JSObject:"ATT.rtc.Phone",JSMethod:"dial",ErrorCode:"4005",ErrorMessage:"Can not make second call. Please put the current call on hold before making second call.",Cause:"Invalid operation",Resolution:"Please ensure that current call is on hold before making second call"},{JSObject:"ATT.rtc.Phone",JSMethod:"dial",ErrorCode:"4006",ErrorMessage:"parameter `localMedia` is not defined",Cause:"localMedia is not defined",Resolution:"Please include `localMedia` parameter"},{JSObject:"ATT.rtc.Phone",JSMethod:"dial",ErrorCode:"4007",ErrorMessage:"parameter `remoteMedia` is not defined",Cause:"remoteMedia is not defined",Resolution:"Please include `remoteMedia` parameter"},{JSObject:"ATT.rtc.Phone",JSMethod:"dial",ErrorCode:"4008",ErrorMessage:"parameter `destination` is not defined",Cause:"destination is not defined",Resolution:"Please include `destination` parameter"},{JSObject:"ATT.rtc.Phone",JSMethod:"dial",ErrorCode:"4009",ErrorMessage:"options are not defined",Cause:"options are not defined",Resolution:"Please include the required parameters"},{JSObject:"ATT.rtc.Phone",JSMethod:"dial",ErrorCode:"4010",ErrorMessage:"Cannot have more than 2 calls at same time",Cause:"Only one foreground call and one background call is supported",Resolution:"Please hangup current or background call before making another call"},{JSObject:"ATT.rtc.Phone",JSMethod:"answer",ErrorCode:"5000",ErrorMessage:"Answer failed- No incoming call",Cause:"No incoming call",Resolution:"No incoming call"},{JSObject:"ATT.rtc.Phone",JSMethod:"answer",ErrorCode:"5001",ErrorMessage:"Invalid media type",Cause:"Invalid media constraints",Resolution:"Please provide use valid Media constraints attributes"},{JSObject:"ATT.rtc.Phone",JSMethod:"answer",ErrorCode:"5002",ErrorMessage:"Internal error occurred",Cause:"Uncaught error",Resolution:"Please check the logs and contact support if needed"},{JSObject:"ATT.rtc.Phone",JSMethod:"answer",ErrorCode:"5003",ErrorMessage:"User is not logged in",Cause:"Invalid operation",Resolution:"Please login first before invoking answer"},{JSObject:"ATT.rtc.Phone",JSMethod:"answer",ErrorCode:"5004",ErrorMessage:"Mandatory fields can not be empty",Cause:"One of the Mandatory Parameters is empty",Resolution:"Please check the values for input parameters"},{JSObject:"ATT.rtc.Phone",JSMethod:"answer",ErrorCode:"5005",ErrorMessage:"Invalid Action parameter",Cause:"Action can only be `hold` or `end`",Resolution:"Please provide a valid action (hold or end)"},{JSObject:"ATT.rtc.Phone",JSMethod:"hangup",ErrorCode:"6000",ErrorMessage:"Hangup failed- Call is not in progress",Cause:"Can not hangup before the call is established",Resolution:"Please use cancel call, or allow call to be established before trying to hang-up."},{JSObject:"ATT.rtc.Phone",JSMethod:"hangup",ErrorCode:"6001",ErrorMessage:"Internal error occurred",Cause:"Uncaught error",Resolution:"Please check the logs and contact support if needed"},{JSObject:"ATT.rtc.Phone",JSMethod:"hold",ErrorCode:"7000",ErrorMessage:"Hold failed- Call is not in progress",Cause:"Cannot hold. There is no active call in progress.",Resolution:"Please ensure an active call is in progress before trying to put the call on Hold."},{JSObject:"ATT.rtc.Phone",JSMethod:"hold",ErrorCode:"7001",ErrorMessage:"Internal error occurred",Cause:"Uncaught error",Resolution:"Please check the logs and contact support if needed"},{JSObject:"ATT.rtc.Phone",JSMethod:"resume",ErrorCode:"8000",ErrorMessage:"Resume failed- Call is not in progress",Cause:"There is no active call in progress.",Resolution:"Please ensure an active call is in progress."},{JSObject:"ATT.rtc.Phone",JSMethod:"resume",ErrorCode:"8001",ErrorMessage:"Resume failed- An invalid operation or call is not on hold",Cause:"Invalid operation",Resolution:"Please confirm that an active call is on Hold before trying to Resume."},{JSObject:"ATT.rtc.Phone",JSMethod:"resume",ErrorCode:"8002",ErrorMessage:"Internal error occurred",Cause:"Uncaught error",Resolution:"Please check the logs and contact support if needed"},{JSObject:"ATT.rtc.Phone",JSMethod:"mute",ErrorCode:"9000",ErrorMessage:"Mute failed- Call is not in progress",Cause:"No media stream",Resolution:"Please confirm that an active call is in progress."},{JSObject:"ATT.rtc.Phone",JSMethod:"mute",ErrorCode:"9001",ErrorMessage:"Internal error occurred",Cause:"Uncaught error",Resolution:"Please check the logs and contact support if needed"},{JSObject:"ATT.rtc.Phone",JSMethod:"mute",ErrorCode:"9002",ErrorMessage:"Mute failed- Already muted",Cause:"Duplicate operation",Resolution:""},{JSObject:"ATT.rtc.Phone",JSMethod:"unmute",ErrorCode:"10000",ErrorMessage:"Unmute failed- No media stream",Cause:"No media stream",Resolution:"Please confirm that an active call is in progress."},{JSObject:"ATT.rtc.Phone",JSMethod:"unmute",ErrorCode:"10001",ErrorMessage:"Internal error occurred",Cause:"Uncaught error",Resolution:"Please check the logs and contact support if needed"},{JSObject:"ATT.rtc.Phone",JSMethod:"unmute",ErrorCode:"10002",ErrorMessage:"Unmute failed- Already Unmuted",Cause:"Duplicate operation",Resolution:""},{JSObject:"ATT.rtc.Phone",JSMethod:"cancel",ErrorCode:"11000",ErrorMessage:"Cancel failed-Call has not been initiated",Cause:"No call to cancel in progress",Resolution:"Please invoke dial before invoking cancel"},{JSObject:"ATT.rtc.Phone",JSMethod:"cancel",ErrorCode:"11001",ErrorMessage:"Internal error occurred",Cause:"Uncaught error",Resolution:"Please check the logs and contact support if needed"},{JSObject:"ATT.rtc.Phone",JSMethod:"reject",ErrorCode:"12000",ErrorMessage:"Reject failed-Call has not been initiated",Cause:"No call to reject",Resolution:"Reject can be performed only on incoming call"},{JSObject:"ATT.rtc.Phone",JSMethod:"reject",ErrorCode:"12001",ErrorMessage:"Internal error occurred",Cause:"Uncaught error",Resolution:"Please check the logs and contact support if needed"},{JSObject:"ATT.rtc.Phone",JSMethod:"*",ErrorCode:"13000",ErrorMessage:"Unable to send information about this party",Cause:"PeerConnection Create offer failed",Resolution:"Please check the logs on the console"},{JSObject:"ATT.rtc.Phone",JSMethod:"*",ErrorCode:"13001",ErrorMessage:"Unable to acknowledge other party",Cause:"PeerConnection Create answer failed",Resolution:"Please check the logs on the console"},{JSObject:"ATT.rtc.Phone",JSMethod:"*",ErrorCode:"13002",ErrorMessage:"Local media description not accepted by connection",Cause:"PeerConnection setLocalDescription failed",Resolution:"Please check the logs on the console"},{JSObject:"ATT.rtc.Phone",JSMethod:"*",ErrorCode:"13003",ErrorMessage:"Other party media description not accepted by connection",Cause:"PeerConnection setRemoteDescription failed",Resolution:"Please check the logs on the console"},{JSObject:"ATT.rtc.Phone",JSMethod:"*",ErrorCode:"13004",ErrorMessage:"Negotiation for connectivity failed",Cause:"PeerConnection addIceCandidate failed",Resolution:"Please check the logs on the console"},{JSObject:"ATT.rtc.Phone",JSMethod:"*",ErrorCode:"13005",ErrorMessage:"onUserMediaError",Cause:"Failed to get the UserMedia",Resolution:"Please enable Media for the browser "},{JSObject:"ATT.rtc.Phone",JSMethod:"*",ErrorCode:"14000",ErrorMessage:"Permission denied to access audio/video",Cause:"User denied permission",Resolution:"User may intentionally have denied permission, please retry the requested operation"},{JSObject:"ATT.rtc.Phone",JSMethod:"*",ErrorCode:"14001",ErrorMessage:"Unsupported browser-unable to get audio/video",Cause:"Unsupported browser",Resolution:"The browser does not support Enhanced WebRTC, please use Enhanced WebRTC supported browser"},{JSObject:"ATT.rtc.Phone",JSMethod:"*",ErrorCode:"14002",ErrorMessage:"Invalid input for media request",Cause:"Invalid media constraints",Resolution:"Please check the media constraints"},{JSObject:"ATT.rtc.Phone",JSMethod:"*",ErrorCode:"15000",ErrorMessage:"Cannot interpret other party's state",Cause:"Unable to Setup Event Interceptor. Please contact support.",Resolution:"Please contact support"},{JSObject:"ATT.rtc.Phone",JSMethod:"*",ErrorCode:"15001",ErrorMessage:"Event Channel unable to shutdown gracefully",Cause:"Unable to shut down event channel. Please logout and login again.",Resolution:"Please login again"},{JSObject:"ATT.rtc.Phone",JSMethod:"*",ErrorCode:"15002",ErrorMessage:"Event Channel got shutdown unexpectedly",Cause:"Event Channel stopped. Please logout and login again.",Resolution:"Please login again"},{JSObject:"ATT.rtc.Phone",JSMethod:"associateE911Id",ErrorCode:"17000",ErrorMessage:"e911Id parameter missing",Cause:"Once or more required input parameter(s) are missing",Resolution:"Please pass E911Id as a parameter"},{JSObject:"ATT.rtc.Phone",JSMethod:"associateE911Id",ErrorCode:"17001",ErrorMessage:"Internal error occurred",Cause:"Uncaught error",Resolution:"Please check the logs and contact support if needed"},{JSObject:"ATT.rtc.Phone",JSMethod:"associateE911Id",ErrorCode:"17002",ErrorMessage:"Could not update E911 Id, E911 Id could be updated only for ongoing session",Cause:"Precondition failed",Resolution:"E911 Id can be updated only for ongoing session, Please login and then update E911 Id if necessary"},{JSObject:"ATT.rtc.Phone",JSMethod:"startConference",ErrorCode:"18000",ErrorMessage:"parameters missing",Cause:"no parameter passed ",Resolution:"Please pass parameters to startConference"},{JSObject:"ATT.rtc.Phone",JSMethod:"startConference",ErrorCode:"18001",ErrorMessage:"Invalid localMedia passed ",Cause:"localMedia parameter missing",Resolution:"Please pass localMedia as a parameter for start conference"},{JSObject:"ATT.rtc.Phone",JSMethod:"startConference",ErrorCode:"18002",ErrorMessage:"Invalid remoteMedia passed",Cause:"remoteMedia parameter missing",Resolution:"Please pass remoteMedia as a parameter for start conference"},{JSObject:"ATT.rtc.Phone",JSMethod:"startConference",ErrorCode:"18003",ErrorMessage:"Invalid mediatype passed ",Cause:"mediatype parameter missing",Resolution:"please pass mediatype as a parameter for start conference"},{JSObject:"ATT.rtc.Phone",JSMethod:"startConference",ErrorCode:"18004",ErrorMessage:"Internal error occurred",Cause:"onUserMediaError",Resolution:"Please check the logs and contact support if needed"},{JSObject:"ATT.rtc.Phone",JSMethod:"startConference",ErrorCode:"18005",ErrorMessage:"Internal error occurred",Cause:"Uncaught error",Resolution:"Please check the logs and contact support if needed"},{JSObject:"ATT.rtc.Phone",JSMethod:"startConference",ErrorCode:"18006",ErrorMessage:"Cannot make second conference when first in progress",Cause:"conference already exists",Resolution:"Please End your current Conference"},{JSObject:"ATT.rtc.Phone",JSMethod:"startConference",ErrorCode:"18007",ErrorMessage:"User not login to make conference",Cause:"User not logged In",Resolution:"Please login before you make a conference"},{JSObject:"ATT.rtc.Phone",JSMethod:"addParticipant",ErrorCode:"19000",ErrorMessage:"participant parameter missing",Cause:"One or more required input parameter(s) are missing",Resolution:"Please provide participant parameter"},{JSObject:"ATT.rtc.Phone",JSMethod:"addParticipant",ErrorCode:"19001",ErrorMessage:"Internal error occurred",Cause:"Uncaught error",Resolution:"Please check the logs and contact support if needed"},{JSObject:"ATT.rtc.Phone",JSMethod:"joinConference",ErrorCode:"20000",ErrorMessage:"Internal error occurred",Cause:"Uncaught error",Resolution:"Please check the logs and contact support if needed"},{JSObject:"ATT.rtc.Phone",JSMethod:"joinConference",ErrorCode:"20001",ErrorMessage:"User is not logged in",Cause:"Invalid operation",Resolution:"Please login first before invoking join conference"},{JSObject:"ATT.rtc.Phone",JSMethod:"joinConference",ErrorCode:"20002",ErrorMessage:"No conference invite",Cause:"Invalid operation",Resolution:"Cannot join conference before receiving an invite"},{JSObject:"ATT.rtc.Phone",JSMethod:"rejectConference",ErrorCode:"22000",ErrorMessage:"Internal error occurred",Cause:"Uncaught error",Resolution:"Please check the logs and contact support if needed"},{JSObject:"ATT.rtc.Phone",JSMethod:"rejectConference",ErrorCode:"22001",ErrorMessage:"User is not logged in",Cause:"Invalid operation",Resolution:"Please login first before invoking reject conference"},{JSObject:"ATT.rtc.Phone",JSMethod:"rejectConference",ErrorCode:"22002",ErrorMessage:"No conference invite",Cause:"Invalid operation",Resolution:"Cannot reject conference before receiving an invite"},{JSObject:"ATT.rtc.Phone",JSMethod:"getParticipants",ErrorCode:"21000",ErrorMessage:"Conference not initiated",Cause:"Invalid operation",Resolution:"Please invoke conference first before invoking getParticipants"},{JSObject:"ATT.rtc.Phone",JSMethod:"getParticipants",ErrorCode:"21001",ErrorMessage:"Internal error occurred",Cause:"Uncaught error",Resolution:"Please check the logs and contact support if needed"},{JSObject:"ATT.rtc.Phone",JSMethod:"getParticipants",ErrorCode:"21002",ErrorMessage:"User is not logged in",Cause:"Invalid operation",Resolution:"Please login first before invoking getParticipants"},{JSObject:"ATT.rtc.Phone",JSMethod:"endConference",ErrorCode:"23000",ErrorMessage:"Internal error occurred",Cause:"Uncaught error",Resolution:"Please check the logs and contact support if needed"},{JSObject:"ATT.rtc.Phone",JSMethod:"endConference",ErrorCode:"23001",ErrorMessage:"User is not logged in",Cause:"Invalid operation",Resolution:"Please login first before invoking endConference"},{JSObject:"ATT.rtc.Phone",JSMethod:"endConference",ErrorCode:"23002",ErrorMessage:"endConference failed - Conference is not in progress",Cause:"Cannot end Conference before the conference is established",Resolution:"Allow conference to be established before trying to end"},{JSObject:"ATT.rtc.Phone",JSMethod:"addParticipants",ErrorCode:"24000",ErrorMessage:"participants parameter missing",Cause:"One or more required input parameter(s) are missing",Resolution:"Please provide participants parameter"},{JSObject:"ATT.rtc.Phone",JSMethod:"addParticipants",ErrorCode:"24001",ErrorMessage:"User is not logged in",Cause:"One or more required input parameter(s) are not correct",Resolution:"Please provide participants parameter of type array"},{JSObject:"ATT.rtc.Phone",JSMethod:"addParticipants",ErrorCode:"24002",ErrorMessage:"participants parameter incorrect",Cause:"Invalid operation",Resolution:"Please login first before invoking addParticipants"},{JSObject:"ATT.rtc.Phone",JSMethod:"addParticipants",ErrorCode:"24003",ErrorMessage:"Conference not initiated",Cause:"Invalid operation",Resolution:"Please invoke conference first before invoking addParticipants"},{JSObject:"ATT.rtc.Phone",JSMethod:"addParticipants",ErrorCode:"24004",ErrorMessage:"Internal error occurred",Cause:"Uncaught error",Resolution:"Please check the logs and contact support if needed"},{JSObject:"ATT.rtc.Phone",JSMethod:"addParticipants",ErrorCode:"24005",ErrorMessage:"Cannot invite existing participant",Cause:"Invalid operation",Resolution:"Please invite new user"},{JSObject:"ATT.rtc.Phone",JSMethod:"addParticipants",ErrorCode:"24006",ErrorMessage:"Invalid input parameter",Cause:"Invalid phone number",Resolution:"Please provide valid 10 digit phone number"},{JSObject:"ATT.rtc.Phone",JSMethod:"addParticipants",ErrorCode:"24007",ErrorMessage:"Invalid input parameter",Cause:"Invalid SIP URI",Resolution:"Please provide valid SIP URI"},{JSObject:"ATT.rtc.Phone",JSMethod:"removeParticipant",ErrorCode:"25000",ErrorMessage:"User is not logged in",Cause:"Invalid operation",Resolution:"Please login first before invoking removeParticipant"},{JSObject:"ATT.rtc.Phone",JSMethod:"removeParticipant",ErrorCode:"25001",ErrorMessage:"removeParticipant failed - Conference is not in progress",Cause:"Cannot remove participant before the conference is established",Resolution:"Allow conference to be established before trying to remove participant"},{JSObject:"ATT.rtc.Phone",JSMethod:"removeParticipant",ErrorCode:"25002",ErrorMessage:"participant parameter missing",Cause:"One or more required input parameter(s) are missing",Resolution:"Please provide participant parameter"},{JSObject:"ATT.rtc.Phone",JSMethod:"removeParticipant",ErrorCode:"25003",ErrorMessage:"Internal error occurred",Cause:"Uncaught error",Resolution:"Please check the logs and contact support if needed"},{JSObject:"ATT.rtc.Phone",JSMethod:"CleanNumber",ErrorCode:"26001",ErrorMessage:"Number Invalid",Cause:"Invalid PhoneNumber passed",Resolution:"Please check the logs and pass a valid phone number"},{JSObject:"ATT.rtc.Phone",JSMethod:"addCall",ErrorCode:"27000",ErrorMessage:"Internal error occurred",Cause:"Uncaught error",Resolution:"Please check the logs and contact support if needed"},{JSObject:"ATT.rtc.Phone",JSMethod:"addCall",ErrorCode:"27001",ErrorMessage:"Invalid options provided",Cause:"Input options are not provided",Resolution:"Please include the required parameters"},{JSObject:"ATT.rtc.Phone",JSMethod:"addCall",ErrorCode:"27002",ErrorMessage:"parameter `localMedia` is not defined",Cause:"LocalMedia is not defined",Resolution:"Please include localMedia parameter"},{JSObject:"ATT.rtc.Phone",JSMethod:"addCall",ErrorCode:"27003",ErrorMessage:"parameter `remoteMedia` is not defined",Cause:"remoteMedia is not defined",Resolution:"Please include remoteMedia parameter"},{JSObject:"ATT.rtc.Phone",JSMethod:"addCall",ErrorCode:"27004",ErrorMessage:"parameter `destination` is not defined",Cause:"destination is not defined",Resolution:"Please include destination parameter"},{JSObject:"ATT.rtc.Phone",JSMethod:"addCall",ErrorCode:"27005",ErrorMessage:"Invalid input parameter",Cause:"Invalid phone number",Resolution:"Please provide valid phone number"},{JSObject:"ATT.rtc.Phone",JSMethod:"addCall",ErrorCode:"27006",ErrorMessage:"Invalid input parameter",Cause:"Invalid SIP URI",Resolution:"Please provide valid SIP URI"},{JSObject:"ATT.rtc.Phone",JSMethod:"addCall",ErrorCode:"27007",ErrorMessage:"Invalid media type",Cause:"Invalid media constraints",Resolution:"Please provide use valid Media constraints attributes"},{JSObject:"ATT.rtc.Phone",JSMethod:"addCall",ErrorCode:"27008",ErrorMessage:"User is not logged in",Cause:"Invalid operation",Resolution:"Please login first before invoking dial"},{JSObject:"ATT.rtc.Phone",JSMethod:"addCall",ErrorCode:"27009",ErrorMessage:"Can not make second call. There is no first call in progress.",Cause:"Invalid operation",Resolution:"Please ensure that there is an existing call in progress before making second call"},{JSObject:"ATT.rtc.Phone",JSMethod:"addCall",ErrorCode:"27010",ErrorMessage:"Cannot make a third call.",Cause:"Trying to make a third call.",Resolution:"Please end one of the calls."},{JSObject:"ATT.rtc.Phone",JSMethod:"move",ErrorCode:"28000",ErrorMessage:"User is not logged in",Cause:"Invalid operation",Resolution:"Please login first before invoking move"},{JSObject:"ATT.rtc.Phone",JSMethod:"move",ErrorCode:"28001",ErrorMessage:"Move failed - call is not in progress",Cause:"Cannot move. There is no active call in progress.",Resolution:"Please ensure an active call is in progress before trying to move the call"},{JSObject:"ATT.rtc.Phone",JSMethod:"move",ErrorCode:"28002",ErrorMessage:"Internal error occurred",Cause:"Uncaught error",Resolution:"Please check the logs and contact support if needed"},{JSObject:"ATT.rtc.Phone",JSMethod:"transfer",ErrorCode:"29000",ErrorMessage:"Internal error occurred",Cause:"Uncaught error",Resolution:"Please check the logs and contact support if needed"},{JSObject:"ATT.rtc.Phone",JSMethod:"transfer",ErrorCode:"29001",ErrorMessage:"User is not logged in",Cause:"Invalid operation",Resolution:"Please login first before invoking transfer"},{JSObject:"ATT.rtc.Phone",JSMethod:"transfer",ErrorCode:"29002",ErrorMessage:"transfer failed - call is not in progress",Cause:"Cannot transfer. There is no active call in progress.",Resolution:"Please ensure an active call is in progress before trying to transfer the call"},{JSObject:"ATT.rtc.Phone",JSMethod:"transfer",ErrorCode:"29003",ErrorMessage:"Cannot make a third call",Cause:"Trying to make a third call",Resolution:"Please end one of the calls"},{JSObject:"ATT.rtc.Phone",JSMethod:"switch",ErrorCode:"30000",ErrorMessage:"Internal error occurred",Cause:"Uncaught error",Resolution:"Please check the logs and contact support if needed"},{JSObject:"ATT.rtc.Phone",JSMethod:"switch",ErrorCode:"30001",ErrorMessage:"User is not logged in",Cause:"Invalid operation",Resolution:"Please login first before invoking switch"},{JSObject:"ATT.rtc.Phone",JSMethod:"switch",ErrorCode:"30002",ErrorMessage:"Switch failed - call is not in progress",Cause:"Cannot switch. There is no active call in progress.",Resolution:"Please ensure an active call is in progress before trying to invoke switch"},{JSObject:"ATT.rtc.Phone",JSMethod:"switch",ErrorCode:"30003",ErrorMessage:"Switch failed - only one call is in progress",Cause:"Trying to invoke switch when only one call is established",Resolution:"Please create two calls before invoking switch"}];
if(void 0===window.ATT.utils)throw new Error("Cannot export SDK Errors into ATT.utils.ErrorStore.SDKErrors, ATT.utils namespace is undefined...\n ATT: "+JSON.stringify(window.ATT));window.ATT.utils.ErrorStore={},window.ATT.utils.ErrorStore.SDKErrors={getAllSDKErrors:function(){var c,d,e={};for(c=0;c<b.length;c+=1)d=b[c].ErrorCode,e[d]=b[c];return a(e)}}}(),function(){"use strict";var a=[{JSObject:"ATT.rtc",JSMethod:"*",ErrorCode:2500,ErrorMessage:"System error occurred",PossibleCauses:"System error occurred",PossibleResolution:"Use the explanation to find the reason for failure.",APIError:"SVC0001: A service error has occurred. Error code is <error_explanation>",ResourceMethod:"POST /RTC/v1/sessions",HttpStatusCode:400,MessageId:"SVC0001"},{JSObject:"ATT.rtc",JSMethod:"*",ErrorCode:2501,ErrorMessage:"Mandatory parameter is missing in the Request.",PossibleCauses:"Mandatory parameter is missing in the request.",PossibleResolution:"The parameter name is suggested in the error text. message part contains the missing parameter name.",APIError:"SVC0002 - Invalid input value for message part <part_name>",ResourceMethod:"POST /RTC/v1/sessions",HttpStatusCode:400,MessageId:"SVC0002"},{JSObject:"ATT.rtc",JSMethod:"*",ErrorCode:2502,ErrorMessage:"Invalid values provided for a parameter in the Request.",PossibleCauses:"Invalid values are passed in the Request.",PossibleResolution:"Pass the valid values as suggested in the error response.",APIError:"SVC0003 - Invalid input value for message part <part_name>, valid values are <part_values>",ResourceMethod:"POST /RTC/v1/sessions",HttpStatusCode:400,MessageId:"SVC0003"},{JSObject:"ATT.rtc",JSMethod:"login",ErrorCode:2504,ErrorMessage:"E911 not supported for non-telephone users",PossibleCauses:"E911 Id is not required a parameter for this user type (account id)",PossibleResolution:"Please dont pass E911 id to login for account id users",APIError:"SVC8510:E911 not supported for non-telephone users",ResourceMethod:"POST /RTC/v1/sessions",HttpStatusCode:400,MessageId:"SVC8510"},{JSObject:"ATT.rtc",JSMethod:"login",ErrorCode:2505,ErrorMessage:"Valid e911Id is mandatory for mobile number or virtual number",PossibleCauses:"1. x-e911Id is missing in the request. x-e911Id is invalid.",PossibleResolution:"e911Id should be retrieved using E911 API and appropriately passed in the Create Session Request.",APIError:"SVC8511:Valid e911Id is mandatory for <part_value>",ResourceMethod:"POST /RTC/v1/sessions",HttpStatusCode:400,MessageId:"SVC8511"},{JSObject:"ATT.rtc",JSMethod:"login",ErrorCode:2506,ErrorMessage:"Unassigned token Associate token to virtual number or account id",PossibleCauses:"Access token not assigned to virtual number or account id.",PossibleResolution:"Call Associate token operation before Create Session for virtual number or account id scenario.",APIError:"SVC8512:Unassigned token Associate token to virtual number or account id",ResourceMethod:"POST /RTC/v1/sessions",HttpStatusCode:400,MessageId:"SVC8512"},{JSObject:"ATT.rtc",JSMethod:"login",ErrorCode:2507,ErrorMessage:"Token in use.",PossibleCauses:"A session was already created with the AT",PossibleResolution:"In case user abruptly closed the application, called to expire the token and receive new token.",APIError:"SVC8513:Token in use.",ResourceMethod:"POST /RTC/v1/sessions",HttpStatusCode:400,MessageId:"SVC8513"},{JSObject:"ATT.rtc",JSMethod:"*",ErrorCode:2508,ErrorMessage:"Access token is invalid.",PossibleCauses:"vAccess Token is incorrect or in valid.Access token is not authorized for the Enhanced WebRTC scope.",PossibleResolution:"Re-Authenticate and retrieve the correct access token.",APIError:"POL0001:A policy error occurred. For example, rateit error, authentication and authorization errors",ResourceMethod:"POST /RTC/v1/sessions",HttpStatusCode:401,MessageId:"POL0001"},{JSObject:"ATT.rtc",JSMethod:"*",ErrorCode:2509,ErrorMessage:"Invalid token",PossibleCauses:"Access Token is incorrect or in valid.",PossibleResolution:"Re-Authenticate and retrieve the correct access token for Enhanced WebRTC",APIError:"POL0002:Privacy verification failed for address <address> request is refused",ResourceMethod:"POST /RTC/v1/sessions",HttpStatusCode:403,MessageId:"POL0002"},{JSObject:"ATT.rtc",JSMethod:"*",ErrorCode:2510,ErrorMessage:"Not implemented",PossibleCauses:"Reserved for future use",PossibleResolution:"Reserved for future use",APIError:"POL0003:Too many addresses specified in Message part",ResourceMethod:"POST /RTC/v1/sessions",HttpStatusCode:403,MessageId:"POL0003"},{JSObject:"ATT.rtc",JSMethod:"*",ErrorCode:2511,ErrorMessage:"User has not been provisioned for Enhanced WebRTC",PossibleCauses:"User has not been provisioned for Enhanced WebRTC service",PossibleResolution:"End user needs to provide consent to get provisioned.",APIError:"POL1009:User has not been provisioned for %1",ResourceMethod:"POST /RTC/v1/sessions",HttpStatusCode:403,MessageId:"POL1009"},{JSObject:"ATT.rtc",JSMethod:"login",ErrorCode:2512,ErrorMessage:"Number of Session exceeds the allowed limit.",PossibleCauses:"For virtual number and account id users: Since virtual number is assigned to a specific user.Max number of sessions is defined by the network.",PossibleResolution:"For virtual number and account id scenario, contact Administrator. not get this modified as this is network setting.",APIError:"POL1100:Max number of session exceeded allowed limit %1",ResourceMethod:"POST /RTC/v1/sessions",HttpStatusCode:403,MessageId:"POL1100"},{JSObject:"ATT.rtc",JSMethod:"logout",ErrorCode:3507,ErrorMessage:"Session Id is not associate with the Access Token passed in the request.",PossibleCauses:"Access Token that was passed in the Request is not mapped to the Session Id.",PossibleResolution:"Use the same Access Token that was initially passene that is active in case refresh token was used.",APIError:"POL1102:Session Id not associated with the token",ResourceMethod:"DELETE /RTC/v1/sessions/{sessionid}",HttpStatusCode:403,MessageId:"POL1102"},{JSObject:"ATT.rtc.Phone",JSMethod:"answer",ErrorCode:5504,ErrorMessage:"Duplicate Request",PossibleCauses:"A media modification is in progress for the callId.",PossibleResolution:"Complete the In-Progress Media modification before initiating another request.",APIError:"SVC8501: Call <callid> in progress",ResourceMethod:"PUT /RTC/v1/sessions/{sessionid}/calls/{callid}",HttpStatusCode:409,MessageId:"SVC8501"},{JSObject:"ATT.rtc.Phone",JSMethod:"hold",ErrorCode:7508,ErrorMessage:"Duplicate Request",PossibleCauses:"A media modification is in progress for the callId.",PossibleResolution:"Complete the In-Progress Media modification before initiating another request.",APIError:"SVC8501: Call <callid> in progress",ResourceMethod:"PUT /RTC/v1/sessions/{sessionid}/calls/{callid}",HttpStatusCode:409,MessageId:"SVC8501"},{JSObject:"ATT.rtc.Phone",JSMethod:"resume",ErrorCode:8508,ErrorMessage:"Duplicate request",PossibleCauses:"A media modification is in progress for the callId.",PossibleResolution:"Complete the In-Progress Media modification before initiating another request.",APIError:"SVC8501: Call <callid> in progress",ResourceMethod:"PUT /RTC/v1/sessions/{sessionid}/calls/{callid}",HttpStatusCode:409,MessageId:"SVC8501"},{JSObject:"ATT.rtc.Phone",JSMethod:"createE911Id",ErrorCode:16503,ErrorMessage:"Address provided by the end user is not geo codable.",PossibleCauses:"The address provided is unreachable.",PossibleResolution:"Correct the portion of address as per the error text and retry.",APIError:"SVC0015: Address is not valid address for E911 routing.Reason",ResourceMethod:"POST emergencyServices/v1/e911Location",HttpStatusCode:400,MessageId:"SVC0015"},{JSObject:"ATT.rtc.Phone",JSMethod:"createE911Id",ErrorCode:16504,ErrorMessage:"The address provided is not present in the System.",PossibleCauses:"The address provided is not present in the System.",PossibleResolution:"Confirm the address by setting isAddressConfirmed to true and retry.",APIError:"SVC0016: Address Confirmation Required ",ResourceMethod:"POST emergencyServices/v1/e911Location",HttpStatusCode:400,MessageId:"SVC0016"},{JSObject:"ATT.rtc.Phone",JSMethod:"createE911Id",ErrorCode:16505,ErrorMessage:"System is unavailable to process the request.",PossibleCauses:"System is unavailable to process the request.",PossibleResolution:"Please try again later.",APIError:"SVC0017: NENA provider system is not?available.",ResourceMethod:"POST emergencyServices/v1/e911Location",HttpStatusCode:400,MessageId:"SVC0017"},{JSObject:"ATT.rtc.Phone",JSMethod:"createE911Id",ErrorCode:16506,ErrorMessage:"System is available but could not process the request.",PossibleCauses:"System is available but could not process the request.",PossibleResolution:"Please contact system administrator.",APIError:"SVC0018: NENA provider system error",ResourceMethod:"POST emergencyServices/v1/e911Location",HttpStatusCode:400,MessageId:"SVC0018"},{JSObject:"ATT.rtc.Phone",JSMethod:"createE911Id",ErrorCode:16507,ErrorMessage:"Access token is invalid.",PossibleCauses:"1. Access Token is incorrect or in valid.?2. Access token is not authorized for the Enhanced WebRTC scope.",PossibleResolution:"Re-Authenticate and retrieve the correct access token.",APIError:"POL0001:A policy error occurred. For example, rateit error, authentication and authorization errors",ResourceMethod:"POST emergencyServices/v1/e911Location",HttpStatusCode:401,MessageId:"POL0001"},{JSObject:"ATT.rtc.Phone",JSMethod:"createE911Id",ErrorCode:16508,ErrorMessage:"Invalid token",PossibleCauses:"Access Token is incorrect or in valid.",PossibleResolution:"Re-Authenticate and retrieve the correct access token for Enhanced WebRTC",APIError:"POL0002:Privacy verification failed for address <address> request is refused",ResourceMethod:"POST emergencyServices/v1/e911Location",HttpStatusCode:403,MessageId:"POL0002"},{JSObject:"ATT.rtc.Phone",JSMethod:"createE911Id",ErrorCode:16509,ErrorMessage:"Not implemented",PossibleCauses:"Reserved for future use",PossibleResolution:"Reserved for future use",APIError:"POL0003:Too many addresses specified in Message part",ResourceMethod:"POST emergencyServices/v1/e911Location",HttpStatusCode:403,MessageId:"POL0003"},{JSObject:"ATT.rtc.Phone",JSMethod:"createE911Id",ErrorCode:16511,ErrorMessage:"System error occurred",PossibleCauses:"System error occurred",PossibleResolution:"Use the explanation to find the reason for failure.",APIError:"SVC0001: A service error has occurred. Error code is <error_explanation>",ResourceMethod:"POST emergencyServices/v1/e911Location",HttpStatusCode:400,MessageId:"SVC0001"},{JSObject:"ATT.rtc.Phone",JSMethod:"*",ErrorCode:500,ErrorMessage:"<method name> failed - Unable to complete requested operation",PossibleCauses:"System error occurred",PossibleResolution:"Use the explanation to find the reason for failure.",APIError:"Populated from API response if available",ResourceMethod:"METHOD: Resource URL",HttpStatusCode:500,MessageId:""},{JSObject:"ATT.rtc.Phone",JSMethod:"*",ErrorCode:502,ErrorMessage:"<method name> failed - Unable to complete requested operation",PossibleCauses:"Please look into API Error",PossibleResolution:"Please look into API Error",APIError:"Populated from API response if available",ResourceMethod:"METHOD: Resource URL",HttpStatusCode:502,MessageId:""},{JSObject:"ATT.rtc.Phone",JSMethod:"*",ErrorCode:503,ErrorMessage:"<method name> failed - Unable to complete requested operation",PossibleCauses:"Bad Gateway",PossibleResolution:"Please look into API Error",APIError:"Populated from API response if available",ResourceMethod:"METHOD: Resource URL",HttpStatusCode:503,MessageId:""},{JSObject:"ATT.rtc.Phone",JSMethod:"*",ErrorCode:504,ErrorMessage:"<method name> failed - Unable to complete requested operation",PossibleCauses:"Service Unavailable",PossibleResolution:"Please look into API Error",APIError:"Populated from API response if available",ResourceMethod:"METHOD: Resource URL",HttpStatusCode:504,MessageId:""}];if(void 0===window.ATT.utils.ErrorStore)throw new Error("Cannot export SDK Errors into ATT.utils.ErrorStore.APIErrors, ATT.utils.ErrorStore namespace is undefined.\n ATT: "+JSON.stringify(window.ATT));window.ATT.utils.ErrorStore.APIErrors={getAllAPIErrors:function(){return a}}}(),function(){"use strict";function a(a,b){function c(a){return a.formatError=function(){var b=a.JSObject+"-"+a.JSMethod+"-"+a.ErrorCode+"-"+a.ErrorMessage+"-"+a.PossibleCauses+"-"+a.PossibleResolution+"-"+a.APIError+"-"+a.ResourceMethod+"-"+a.HttpStatusCode+"-"+a.MessageId;return b},a}function d(a){return a.getId=function(){var b=a.ErrorCode;return b},a}function e(a){return a.getAPIErrorByMethodStatusMsgId=function(){var b=a.JSMethod+a.HttpStatusCode+a.MessageId;return b},a}var f,g={JSObject:"",JSMethod:"",ErrorCode:"",ErrorMessage:"",PossibleCauses:"",PossibleResolution:"",APIError:"",ResourceMethod:"",HttpStatusCode:"",MessageId:""};return f=Object.create(g),f=b.extend(f,a),f=c(f),f=d(f),f=e(f)}function b(b,c){var d=ATT.utils,e=null,f=0,g=[],h=c.length;for(f=0;h>f;f+=1)e=a(c[f],d),g[e.getId()]=e,g[e.getAPIErrorByMethodStatusMsgId()]=e;return{createError:function(b){return a(b,d)},getSDKError:function(a){return b[a]},getError:function(a){return g[a]},getAPIError:function(a,b,c){var d=g[a+b+c];return d||(d=g["*"+b+c],d&&(d.JSMethod=a)),d},getDefaultError:function(b){return a(b,d)}}}var c;c=typeof module,"undefined"!==c&&module.exports?module.exports=b:console.debug("Not exporting to NodeJS...");try{window.ATT.utils.createErrorDictionary=b}catch(d){throw new Error("Error while exporting ATT.errorDictionary.\n ATT = ",JSON.stringify(window.ATT)+"Original Message: "+d.message)}}(),function(){"use strict";function a(a){var b,c=a.getJson(),e={};return c.RequestError?(c.RequestError.ServiceException?e={APIError:c.RequestError.ServiceException.MessageId+":"+c.RequestError.ServiceException.Text+",Variables="+c.RequestError.ServiceException.Variables,MessageId:c.RequestError.ServiceException.MessageId}:c.RequestError.PolicyException?e={APIError:c.RequestError.PolicyException.MessageId+":"+c.RequestError.PolicyException.Text+",Variables="+c.RequestError.PolicyException.Variables,MessageId:c.RequestError.PolicyException.MessageId}:c.RequestError.Exception&&(e={APIError:(c.RequestError.Exception.MessageId||"")+":"+c.RequestError.Exception.Text+",Variables="+c.RequestError.Exception.Variables||"",MessageId:c.RequestError.Exception.MessageId}),e.ResourceMethod=a.getResourceURL(),e.HttpStatusCode=a.getResponseStatus(),e.APIError||(e.APIError=a.responseText,e.MessageId="",d.logError("Unable to parse API Error. Response is empty :"+a)),e):(a.getResponseStatus()>=500?(b=""!==a.getJson()?JSON.stringify(a.getJson()):a.responseText,e=ATT.errorDictionary.getAPIError("*",a.getResponseStatus(),""),e.APIError=b,d.logError("Service Unavailable"),d.logError(a),d.logError(e)):(e={APIError:a.responseText},d.logError(a),d.logError(e)),e.ResourceMethod=a.getResourceURL(),e.HttpStatusCode=a.getResponseStatus(),e)}function b(a,b,c,e){d.logTrace("raw error",a);var f,g;return void 0!==a.HttpStatusCode?g=a:void 0!==a.errorDetail.HttpStatusCode&&(g=a.errorDetail),c=c||"GeneralOperation",e=e||"RTC",0!==g.HttpStatusCode?(f=ATT.errorDictionary.getAPIError(c,g.HttpStatusCode,g.MessageId),void 0!==f&&(f.APIError=g.APIError,f.HttpStatusCode=g.HttpStatusCode,f.MessageId=g.MessageId,f.ResourceMethod=g.ResourceMethod)):f=g,f||(d.logError("Error not found in Error dictionary "),d.logError(a),f=ATT.errorDictionary.getDefaultError({JSObject:b,ErrorCode:e+"-UNKNOWN",JSMethod:c,HttpStatusCode:a.HttpStatusCode||"Unknown",ErrorMessage:c+" failed",APIError:g.APIError||a.responseText,PossibleCauses:"Please look into APIError",PossibleResolution:"Please look into APIError",MessageId:g.MessageId||"",ResourceMethod:g.ResourceMethod||a.getResourceURL()}),d.logError("Generating Missing error response:"+f)),f.JSObject=b,f.JSMethod=c,f.ModuleId=e,f.ErrorMessage=c+" failed - "+f.ErrorMessage,f}var c=ATT.logManager.getInstance(),d=c.getLoggerByName("att.private.error");if(d.logDebug("Initializing error module"),void 0===ATT.private)throw new Error("Error exporting ATT.private.error");ATT.private.error={parseAPIErrorResponse:a,createAPIErrorCode:b}}(),function(){"use strict";function a(){return"function"==typeof navigator.mozGetUserMedia||"function"==typeof navigator.webkitGetUserMedia||"function"==typeof navigator.getUserMedia}function b(){var a,b,c,d,e;if(0===arguments.length)throw new Error("Invalid parameters: pass `options` or `success` callback.");if(0<=arguments.length)for(e=0;e<arguments.length;e+=1)"function"==typeof arguments[e]?0===e?b=arguments[e]:1===e&&(c=arguments[e]):"object"==typeof arguments[e]&&0===e&&(a=arguments[e]);if(void 0!==a&&void 0===a.ewebrtc_domain)throw new Error("`ewebrtc_domain` not provided.");return void 0!==a?void ATT.private.config.app.setAppConfiguration(a):void(void 0!==b&&(d=new ATT.RESTClient({method:"GET",url:"/dhs",success:function(a){ATT.private.config.app.setAppConfiguration(a.getJson()),b()},error:function(a){f.logError("rtc.configure:error"),f.logTrace(a),void 0!==c&&"function"==typeof c&&c(a)}}),d.ajax()))}function c(){var a;return a=ATT.private.config.app.getAppConfiguration(),a.ewebrtc_domain}function d(a){if(void 0===a||0===Object.keys(a).length)throw new Error("No options provided");if(void 0===a.userId)throw new Error("No userId provided");if(void 0===a.token)throw new Error("No token provided");if(void 0===a.success)throw new Error("No success callback provided");if(void 0===a.error)throw new Error("No error callback provided");var b=ATT.private.rtcManager.getRTCManager();b.associateToken(a)}var e=ATT.logManager.getInstance(),f=e.addLoggerForModule("RTC");if(void 0===ATT.rtc)throw new Error("Error exporting ATT.rtc.Phone.");ATT.rtc.configure=b,ATT.rtc.hasEnhancedWebRTC=a,ATT.rtc.getEWebRTCDomain=c,ATT.rtc.associateAccessToken=d}(),function(){"use strict";function a(a){function f(a,b){var d,e,f,g,h,i,j,k;if(d=c.extend({},a),e=a.formatters||{},f=Object.keys(e).length,e&&f>0){if(void 0===b.params||f!==Object.keys(b.params).length)throw l.logError("Params passed in must match number of formatters"),l.logTrace("formatters: "+JSON.stringify(e)),l.logTrace("params: "+JSON.stringify(b.params)),new Error("Params passed in must match number of formatters.");if(e.method&&!b.params.method)throw l.logError("Missing method parameter for the method formatter."),new Error("Missing method parameter for the method formatter.");if(e.url&&!b.params.url)throw l.logError("Missing URL parameter for the URL formatter."),new Error("Missing URL parameter for the URL formatter.");if(e.headers&&Object.keys(b.params.headers).length!==Object.keys(a.formatters.headers).length)throw l.logError("Header formatters in APIConfigs do not match header parameters provided."),new Error("Header formatters in APIConfigs do not match the header parameters being passed in.");if("string"==typeof e.method&&(d.method=b.params.method||a.formatters.method,l.logTrace("updated restConfig method",d.method)),"function"==typeof e.url&&(d.url=a.formatters.url(b.params.url),l.logTrace("updated restConfig url",d.url)),"object"==typeof e.headers&&Object.keys(e.headers).length>0){k={};for(g in b.params.headers)if(b.params.headers.hasOwnProperty(g)){if("options"===g&&"object"==typeof a.formatters.headers[g]){if(0===Object.keys(b.params.headers[g]).length)throw new Error("Options for header not passed in. Cannot construct request");j=Object.keys(b.params.headers[g])[0],h=a.formatters.headers[g][j],i=b.params.headers[g][j],g=j}else h=a.formatters.headers[g],i=b.params.headers[g];k[g]=h(i),l.logDebug("header: "+g+", "+k[g])}d.headers=ATT.utils.extend({},d.headers),d.headers=ATT.utils.extend(d.headers,k)}}return b.data&&(d.data=b.data),d}function g(a){function c(c,e,f){var g;b=ATT.errorDictionary,a.success=c,a.error=function(a){0===a.getResponseStatus()&&""===a.responseText?(a.errorDetail=b.getSDKError("0003"),a.errorDetail.HttpStatusCode=a.getResponseStatus(),a.errorDetail.ResourceMethod=a.getResourceURL(),e.call(this,a.errorDetail)):(a.errorDetail=d.parseAPIErrorResponse(a),e.call(this,a.errorDetail))},a.ontimeout=function(){var c={};c.errorDetail=b.getSDKError("0003"),c.errorDetail.HttpStatusCode=0,c.errorDetail.ResourceMethod=a.url,f?f.call(this,c.errorDetail):e.call(this,c.errorDetail)},g=new ATT.RESTClient(a),g.ajax()}return l.logTrace("configuring REST operation"),c}function h(a,b){var c,d,e,h;if(h=k.getAPIConfiguration(),c=h[a],void 0===c)throw new Error("Operation not found.");if(void 0===b)throw new Error("No options found.");return l.logTrace("do operation",a),d=f(c,b),e=g(d)}function i(a,b){if(void 0===a||0===a.length)throw l.logError("no operation name provided"),new Error("Must specify an operation name.");if(void 0===b||0===Object.keys(b).length)throw new Error("No options found.");if(void 0===b.success)throw new Error("No `success` callback passed.");if("function"!=typeof b.success)throw new Error("`success` callback has to be a function.");if(void 0===b.error)throw new Error("No `error` callback passed.");if("function"!=typeof b.error)throw new Error("`error` callback has to be a function.");try{var c=h(a,b);c(b.success,b.error,b.ontimeout)}catch(d){throw l.logError(d),d}}function j(){return k.getAPIConfiguration()}var k,l=e.addLoggerForModule("ResourceManager");if(void 0===a||0===Object.keys(a).length)throw new Error("No API configuration passed");if(void 0===a.getAPIConfiguration)throw new Error("No `getAPIConfiguration` method found.");return l.logInfo("configuring resource manager module"),k=a,{doOperation:i,getRestOperationsConfig:j}}var b,c=ATT.utils,d=ATT.private.error,e=ATT.logManager.getInstance();if(void 0===ATT.private.factories)throw new Error("Error exporting `createResourceManager`");ATT.private.factories.createResourceManager=a}(),function(){"use strict";function a(a){function e(a){if(r.logDebug("processing events"),m=JSON.parse(u?a.responseText:a.data),r.logDebug("Event data from event channel..."),r.logDebug(m),m.events){var b,c=m.events.eventList;for(b in c)c.hasOwnProperty(b)&&(q.publish("api-event",c[b].eventObject),r.logDebug(c[b].eventObject))}}function f(){r.logInfo("Stopped listening to event channel"),t=!1}function g(a,b){if("api-event"!==a&&"channel-error"!==a)throw new Error("Event not defined");if("function"!=typeof b)throw new Error("Handler is not a function");q.unsubscribe(a,b),q.subscribe(a,b,this)}function h(b,c){r.logDebug(b),r.logInfo("Repolling again..."),204!==c.HttpStatusCode?r.logError("[FATAL] Response code was:"+c+" repolling again..."):0===c.HttpStatusCode?r.logInfo("Request timed out, repolling again"):r.logError("Response code was:"+c+" repolling again..."),setTimeout(function(){a.resourceManager.doOperation(x,s)},0)}function i(b){t=!0,r.logInfo("Listening to event channel"),s={params:{method:u?"GET":"POST",url:{sessionId:a.sessionId,eventChannelUri:u?"events":"websockets"},headers:{Authorization:a.accessToken}},success:n.bind(this,b),error:o.bind(this,b),ontimeout:p.bind(this,b)},a.resourceManager.doOperation(x,s)}var j,k,l,m,n,o,p,q,r,s={},t=!1,u=!0,v=2e3,w=3e5,x="getEvents";try{r=b.getLoggerByName("eventChannel")}catch(y){console.log("Unable to initialize dependencies for Event Channel")}if(r.logInfo("About to create event channel"),void 0===a||0===Object.keys(a).length)throw new Error("No options");if(void 0===a.accessToken)throw new Error("No Access Token");if(void 0===a.sessionId)throw new Error("No Session Id");if(void 0===a.resourceManager)throw new Error("No Resource Manager");return void 0!==a.interval&&(r.logInfo("Configuring interval to "+a.interval),v=a.interval),void 0!==a.maxPollingTime&&(r.logInfo("Configuring maximum polling time to "+a.maxPollingTime),w=a.maxPollingTime),"WebSockets"===a.channelType&&(u=!1),q=c.createEventEmitter(),r.logDebug(s),n=function(b,c){return r.logDebug("on success"),r.logDebug(c),"function"==typeof b.success&&b.success("Sucessfully got response from event channel"),t?u?(r.logDebug("Before processing messages"),200===c.getResponseStatus()&&(e(c),r.logDebug("Processed messages, repolling again...")),void setTimeout(function(){a.resourceManager.doOperation(x,s)},0)):(l=c.getResponseHeader("location"),void(void 0===k&&l&&(k=new WebSocket(l),k.onmessage=function(a){e(a)}))):void r.logDebug("Not processing response because event channel is not running")},o=function(a,b){if(t){if(r.logInfo("onError - Repolling again..."),v=2*v,v>w)return r.logInfo("Stopping Event Channel, maximum polling time reached, interval = "+v+", maximum polling time = "+w),f(),void q.publish("channel-error",d.createAPIErrorCode(b,"ATT.rtc.Phone","events","RTC"));h(a,b)}else r.logError("Event channel is not running..."),r.logError(b)},p=function(a,b){t&&(r.logInfo("Request timed out"),h(a,b))},j={isListening:function(){return t},startListening:i,stopListening:f,on:g}}var b=ATT.logManager.getInstance(),c=ATT.private.factories,d=ATT.private.error;if(void 0===ATT.private.factories)throw new Error("Error exporting `createEventChannel`");ATT.private.factories.createEventChannel=a}(),function(){"use strict";function a(a){function d(a){var b,d,f,g,h=ATT.sdpFilter.getInstance();if(!a)return void e.logError("Not able to consume null event...");switch(e.logDebug("Consumed event from event channel",JSON.stringify(a)),d="calls"===a.type?"call":"conference",f=a.resourceURL.split("/")[4],g=a.resourceURL.split("/")[6],a.sdp&&-1!==a.sdp.indexOf("m=video 0")&&(a.sdp=h.fakeVideo(a.sdp)),a.state){case c.API_EVENT.INVITATION_RECEIVED:b=ATT.sdpFilter.getInstance().getCodecfromSDP(a.sdp),n.publish(c.API_EVENT.INVITATION_RECEIVED+":"+f,{type:d,id:g,from:a.from.split("@")[0].split(":")[1],mediaType:1===b.length?"audio":"video",sdp:a.sdp});break;case c.API_EVENT.MODIFICATION_RECEIVED:n.publish(c.API_EVENT.MODIFICATION_RECEIVED+":"+g,{id:g,remoteSdp:a.sdp,modificationId:a.modId});break;case c.API_EVENT.MODIFICATION_TERMINATED:n.publish(c.API_EVENT.MODIFICATION_TERMINATED+":"+g,{id:g,type:d,remoteSdp:a.sdp,modificationId:a.modId,reason:a.reason,from:a.from});break;case c.API_EVENT.SESSION_OPEN:n.publish(c.API_EVENT.SESSION_OPEN+":"+g,{type:d,id:g,remoteSdp:a.sdp,provisionalSdp:a.provisionalSDP});break;case c.API_EVENT.SESSION_MODIFIED:n.publish(c.API_EVENT.SESSION_MODIFIED+":"+g,{type:d,id:g,remoteSdp:a.sdp});break;case c.API_EVENT.SESSION_TERMINATED:n.publish(c.API_EVENT.SESSION_TERMINATED+":"+g,{type:d,id:g,from:a.from.split("@")[0].split(":")[1],reason:a.reason});break;default:e.logError("Unrecognized event state: "+a.state)}}function f(a){e.logDebug("setupEventChannel");var c={accessToken:a.token,sessionId:a.sessionId,publisher:n,resourceManager:m,channelType:k};l=b.createEventChannel(c),l&&(e.logInfo("Event channel up and running"),l.on("api-event",function(a){d(a)}),l.on("channel-error",function(b){a.onError(b)}),e.logInfo("Subscribed to api-event from event channel"),l.startListening({success:function(a){e.logInfo(a)},error:a.onError})),n.publish("listening")}function g(){l&&(l.stopListening(),e.logInfo("Event channel shutdown successfully")),n.publish("stop-listening")}function h(a,b){n.unsubscribe(a,b)}function i(a,b){if("listening"!==a&&"stop-listening"!==a&&a.indexOf(c.API_EVENT.INVITATION_RECEIVED+":")<0&&a.indexOf(c.API_EVENT.SESSION_OPEN+":")<0&&a.indexOf(c.API_EVENT.SESSION_MODIFIED+":")<0&&a.indexOf(c.API_EVENT.MODIFICATION_RECEIVED+":")<0&&a.indexOf(c.API_EVENT.MODIFICATION_TERMINATED+":")<0&&a.indexOf(c.API_EVENT.SESSION_TERMINATED+":")<0)throw new Error("Event "+a+" not found");n.unsubscribe(a,b),n.subscribe(a,b)}function j(a){if(void 0===a)throw new Error("Options not defined");if(void 0===a.sessionId)throw new Error("Session id is not defined");if(void 0===a.token)throw new Error("Token not defined");f(a)}var k,l,m,n;if(e.logDebug("createEventManager"),void 0===a||0===Object.keys(a).length)throw new Error("Invalid options");if(void 0===a.resourceManager)throw new Error("Must pass `options.resourceManager`");if(void 0===a.eventChannelType)throw new Error("Must pass `options.eventChannelType`");return k=a.eventChannelType,m=a.resourceManager,n=b.createEventEmitter(),{on:i,off:h,setup:j,stop:g}}var b=ATT.private.factories,c=ATT.private.enum,d=ATT.logManager.getInstance(),e=d.getLoggerByName("EventManager");if(void 0===ATT.private.factories)throw new Error("Error exporting createEventManager");ATT.private.factories.createEventManager=a}(),function(){"use strict";function a(a){function d(a){g.logDebug("extractSessionInformation");var b=null,c=null;if(a&&(a.getResponseHeader("Location")&&(b=a.getResponseHeader("Location").split("/")[4]),a.getResponseHeader("x-expires")&&(c=a.getResponseHeader("x-expires"),c=Number(c),c=isNaN(c)?0:1e3*c)),!b)throw"Failed to retrieve session id";return{sessionId:b,timeout:c}}function f(a,b){B.on(a,b)}function i(a,b){B.off(a,b)}function j(a){if(void 0===a||0===Object.keys(a).length)throw new Error("Invalid options");if(void 0===a.sessionId)throw new Error("No session ID passed");if(void 0===a.token)throw new Error("No token passed");if(void 0===a.success)throw new Error("No `success` callback passed");if("function"!=typeof a.success)throw new Error("`success` callback has to be a function");if(void 0===a.error)throw new Error("No `error` callback passed");if("function"!=typeof a.error)throw new Error("`error` callback has to be a function");C.doOperation("refreshWebRTCSession",{success:function(b){g.logInfo("refreshWebRTCSession: success");var c=parseInt(b.getResponseHeader("x-expires"),10);a.success({timeout:(1e3*c).toString()})},error:function(b){g.logError("refreshWebRTCSession: error"),g.logTrace(b),a.onError(c.createAPIErrorCode(b,"ATT.rtc.Phone","refreshSession","RTC"))},params:{url:[a.sessionId],headers:{Authorization:a.token}}})}function k(a){if(void 0===a)throw new Error("No options defined.");if(void 0===a.token)throw new Error("No token defined.");if(void 0===a.onSessionConnected)throw new Error("Callback onSessionConnected not defined.");if(void 0===a.onSessionReady)throw new Error("Callback onSessionReady not defined.");if(void 0===a.onError)throw new Error("Callback onError not defined.");g.logDebug("connectSession");var b=function(b){var c,e;try{g.logDebug("createWebRTCSession: success"),g.logInfo("Successfully created web rtc session on blackflag"),e=d(b),a.onSessionConnected(e),c=function(){g.logInfo("listening@eventManager"),a.onSessionReady({sessionId:e.sessionId}),B.off("listening",c)},B.on("listening",c),B.setup({sessionId:e.sessionId,token:a.token,onError:function(b){g.logError("eventManager.setup: onError"),g.logTrace(b),a.onError(b)}})}catch(f){g.logError(f),a.onError({error:ATT.errorDictionary.getSDKError("2004")})}};C.doOperation("createWebRTCSession",{data:{session:{mediaType:"dtls-srtp",ice:"true",services:["ip_voice_call","ip_video_call"]}},params:{headers:{Authorization:a.token,"x-e911Id":a.e911Id||"","x-Arg":"ClientSDK=WebRTCTestAppJavascript1"}},success:b,error:function(b){g.logError("createWebRTCSession: error"),g.logTrace(b),a.onError(c.createAPIErrorCode(b,"ATT.rtc.Phone","login","RTC"))}})}function l(a){if(void 0===a)throw new Error("No options defined.");if(void 0===a.sessionId)throw new Error("No session id defined.");if(void 0===a.token)throw new Error("No token defined.");if(void 0===a.onSessionDisconnected)throw new Error("Callback onSessionDisconnected not defined.");g.logDebug("disconnectSession"),B.stop(),C.doOperation("deleteWebRTCSession",{params:{url:[a.sessionId],headers:{Authorization:a.token,"x-e911Id":a.e911Id}},success:function(){g.logDebug("deleteWebRTCSession: error"),g.logInfo("Successfully deleted web rtc session on blackflag"),a.onSessionDisconnected()},error:function(b){g.logError("deleteWebRTCSession: error"),g.logTrace(b),a.onError(c.createAPIErrorCode(b,"ATT.rtc.Phone","logout","RTC"))}})}function m(a){var b,c,d,e,f;if(void 0===a)throw new Error("No options provided");if(void 0===a.breed)throw new Error("No call breed provided");if("call"===a.breed&&void 0===a.peer)throw new Error("No peer provided");
if(void 0===a.sessionId)throw new Error("No session id provided");if(void 0===a.token)throw new Error("No token provided");if(void 0===a.description)throw new Error("No description provided");if(void 0===a.onSuccess&&"function"!=typeof a.onSuccess)throw new Error("No success callback provided");if(void 0===a.onError&&"function"!=typeof a.onError)throw new Error("No error callback provided");return void 0===a.callId?(f="call"===a.breed?{call:{calledParty:h.createCalledPartyUri(a.peer),sdp:a.description.sdp}}:{conference:{sdp:a.description.sdp}},d={params:{url:{sessionId:a.sessionId,type:a.breed+"s"},headers:{Authorization:a.token}},data:f,success:function(c){b={id:c.getResponseHeader("Location").split("/")[6],state:c.getResponseHeader("x-state")},a.onSuccess(b)},error:a.onError},void C.doOperation("createCall",d)):(e={Authorization:a.token,options:{}},"call"===a.breed?(e.options["x-calls-action"]="call-answer",f={callsMediaModifications:{sdp:a.description.sdp}}):(e.options["x-conference-action"]="call-answer",f={conferenceModifications:{sdp:a.description.sdp}}),c={params:{url:{sessionId:a.sessionId,callId:a.callId,type:a.breed+"s"},headers:e},data:f,success:function(c){b={state:c.getResponseHeader("x-state")},a.onSuccess(b)},error:a.onError},void C.doOperation("modifyCall",c))}function n(a){var b,c,d="call"===a.breed?"calls":"conferences";b={params:{url:{sessionId:a.sessionId,type:d,callId:a.callId},headers:{Authorization:a.token,"x-modId":a.modId}},data:{callsMediaModifications:{sdp:a.sdp}},success:function(){g.logInfo("acceptMediaModifications: success")},error:function(a){g.logError("acceptMediaModifications: error"),g.logTrace(a)}},c={params:{url:{sessionId:a.sessionId,type:d,callId:a.callId},headers:{Authorization:a.token,"x-mod-Id":a.modId}},data:{conferenceModifications:{sdp:a.sdp}},success:function(){g.logInfo("acceptMediaModifications: success")},error:function(a){g.logError("acceptMediaModifications: error"),g.logTrace(a)}},"calls"===d?C.doOperation("acceptCallModifications",b):C.doOperation("acceptConferenceModifications",c)}function o(a){var b,d;if(void 0===a)throw new Error("No `options` passed");if(void 0===a.sessionInfo)throw new Error("No `sessionInfo` passed");if(void 0===a.confId)throw new Error("No `confId` passed");if("function"!=typeof a.onSuccess)throw new Error("No `onSuccess` callback passed");b=a.invitee.toString(),b=b.indexOf("@")>-1?"sip:"+b:"tel:+"+b,C.doOperation("addParticipant",{params:{url:[a.sessionInfo.sessionId,a.confId,b],headers:{Authorization:a.sessionInfo.token}},success:function(b){g.logInfo("addParticipant Request success"),"add-pending"===b.getResponseHeader("x-state")&&(d=b.getResponseHeader("x-modId"),a.onSuccess(d))},error:function(b){g.logError(b),a.onError(c.createAPIErrorCode(b,"ATT.rtc.Phone","addParticipant","RTC"))}})}function p(a){var b;if(void 0===a)throw new Error("No `options` passed");if(void 0===a.sessionInfo)throw new Error("No `sessionInfo` passed");if(void 0===a.confId)throw new Error("No `confId` passed");if("function"!=typeof a.onSuccess)throw new Error("No `onSuccess` callback passed");b=a.participant.toString(),b=b.indexOf("@")>-1?"sip:"+b:"tel:+"+b,C.doOperation("removeParticipant",{params:{url:[a.sessionInfo.sessionId,a.confId,b],headers:{Authorization:a.sessionInfo.token}},success:function(b){g.logInfo("removeParticipant Request success"),"remove-pending"===b.getResponseHeader("x-state")&&a.onSuccess()},error:function(b){g.logError(b),a.onError(b)}})}function q(a){if(void 0===a)throw new Error("No options provided");if(void 0===a.callId)throw new Error("No CallId provided");if(void 0===a.breed)throw new Error("No call breed provided");if(void 0===a.sessionId)throw new Error("No sessionId provided");if(void 0===a.token)throw new Error("No token provided");if(void 0===a.onSuccess)throw new Error("No success callback provided");if(void 0===a.onError)throw new Error("No error callback provided");var b="call"===a.breed?"hangup":"endConference";C.doOperation("deleteCall",{params:{url:{sessionId:a.sessionId,type:a.breed+"s",callId:a.callId},headers:{Authorization:a.token,"x-delete-reason":"terminate"}},success:function(){g.logInfo("ResourceManager.disconnect request success")},error:function(d){g.logError(d),a.onError(c.createAPIErrorCode(d,"ATT.rtc.Phone",b,"RTC"))}})}function r(a){if(void 0===a)throw new Error("No options provided");if(void 0===a.callId)throw new Error("No callId provided");if(void 0===a.breed)throw new Error("No call breed provided");if(void 0===a.sessionId)throw new Error("No sessionId provided");if(void 0===a.token)throw new Error("No token provided");if(void 0===a.onSuccess)throw new Error("No success callback provided");if(void 0===a.onError)throw new Error("No error callback provided");a.callId.length>0&&C.doOperation("deleteCall",{params:{url:{sessionId:a.sessionId,type:a.breed+"s",callId:a.callId},headers:{Authorization:a.token,"x-delete-reason":"cancel"}},success:function(){g.logInfo("ResourceManager.cancel request success"),a.onSuccess()},error:function(b){g.logError(b),a.onError(c.createAPIErrorCode(b,"ATT.rtc.Phone","cancel","RTC"))}})}function s(a){var b,d,e;if(void 0!==a&&(e="move"===a.action?"move":"hold"),void 0===a)throw new Error("No options provided");if(void 0===a.callId)throw new Error("No callId provided");if(void 0===a.sessionId)throw new Error("No sessionId provided");if(void 0===a.token)throw new Error("No token provided");if(void 0===a.description)throw new Error("No sdp provided");if(void 0===a.breed)throw new Error("No breed provided");if(void 0===a.action)throw new Error("No action provided");if(void 0===a.onSuccess)throw new Error("No success callback provided");if(void 0===a.onError)throw new Error("No error callback provided");d={Authorization:a.token,options:{}},"conference"===a.breed?(b={conferenceModifications:{sdp:a.description.sdp,type:a.description.type}},d.options["x-conference-action"]="initiate-hold"):(b={callsMediaModifications:{sdp:a.description.sdp,type:a.description.type}},d.options["x-calls-action"]="move"===a.action?"initiate-call-move":"initiate-call-hold"),C.doOperation("modifyCall",{params:{url:{sessionId:a.sessionId,type:a.breed+"s",callId:a.callId},headers:d},data:b,success:function(b){204===b.getResponseStatus()?(g.logTrace("modifyCall: success"),a.onSuccess()):(g.logError("modifyCall: error"),a.onError())},error:function(b){g.logError("modifyCall: error"),g.logDebug(b),a.onError(c.createAPIErrorCode(b,"ATT.rtc.Phone",e,"RTC"))}})}function t(a){var b,d;if(void 0===a)throw new Error("No options provided");if(void 0===a.callId)throw new Error("No callId provided");if(void 0===a.sessionId)throw new Error("No sessionId provided");if(void 0===a.token)throw new Error("No token provided");if(void 0===a.description)throw new Error("No sdp provided");if(void 0===a.breed)throw new Error("No breed provided");if(void 0===a.onSuccess)throw new Error("No success callback provided");if(void 0===a.onError)throw new Error("No error callback provided");d={Authorization:a.token,options:{}},"conference"===a.breed?(b={conferenceModifications:{sdp:a.description.sdp,type:a.description.type}},d.options["x-conference-action"]="initiate-resume"):(b={callsMediaModifications:{sdp:a.description.sdp,type:a.description.type}},d.options["x-calls-action"]="initiate-call-resume"),g.logTrace("doOperation: modifyCall"),C.doOperation("modifyCall",{params:{url:{sessionId:a.sessionId,type:a.breed+"s",callId:a.callId},headers:d},data:b,success:function(b){204===b.getResponseStatus()?(g.logTrace("resume request sent..."),a.onSuccess()):a.onError()},error:function(b){a.onError(c.createAPIErrorCode(b,"ATT.rtc.Phone","resume","RTC"))}})}function u(){D.disableMediaStream()}function v(){D.enableMediaStream()}function w(a){var b;if(void 0===a)throw"Invalid options";if(void 0===a.token||""===a.token)throw"No token passed";if(void 0===a.e911Id||""===a.e911Id)throw"No e911Id passed";if(void 0===a.sessionId||""===a.sessionId)throw"No session Id passed";if(void 0===a.onSuccess||"function"!=typeof a.onSuccess)throw"No success callback passed";if(void 0===a.onError||"function"!=typeof a.onError)throw"No error callback passed";b={data:{e911Association:{e911Id:a.e911Id}},params:{url:[a.sessionId],headers:{Authorization:a.token}},success:a.onSuccess,error:function(b){g.logError(b),a.onError(c.createAPIErrorCode(b,"ATT.rtc.Phone","associateE911Id","RTC"))}},C.doOperation("associateE911Id",b)}function x(a){if(void 0===a)throw new Error("No options provided.");if(void 0===a.userId)throw new Error("No userId provided.");if(void 0===a.token)throw new Error("No token provided.");C.doOperation("associateTokenWithUserId",{params:{url:{userId:a.userId},headers:{Authorization:a.token}},success:function(){g.logInfo("associateToken:success"),a.success()},error:function(b){g.logError("associateToken:error"),g.logTrace(b),a.error(b)}})}function y(a){if(void 0===a)throw new Error("Invalid options");if(void 0===a.callId||""===a.callId)throw new Error("No callId provided");if(void 0===a.breed||""===a.breed)throw new Error("No call breed provided");if(void 0===a.sessionId||""===a.sessionId)throw new Error("No session Id provided");if(void 0===a.token||""===a.token)throw new Error("No token provided");if(void 0===a.onSuccess||"function"!=typeof a.onSuccess)throw new Error("No success callback provided");if(void 0===a.onError||"function"!=typeof a.onError)throw new Error("No error callback provided");var b="call"===a.breed?"reject":"rejectConference";C.doOperation("deleteCall",{params:{url:{sessionId:a.sessionId,type:a.breed+"s",callId:a.callId},headers:{Authorization:a.token,"x-delete-reason":"reject"}},success:function(){g.logInfo("RejectCall Request success")},error:function(d){g.logError(d),a.onError(c.createAPIErrorCode(d,"ATT.rtc.Phone",b,"RTC"))}})}function z(a){if(void 0===a||0===Object.keys(a).length)throw new Error("No options provided");if(void 0===a.callId)throw new Error("No call id provided");if(void 0===a.breed)throw new Error("No call breed provided");if(void 0===a.sessionId)throw new Error("No session id provided");if(void 0===a.token)throw new Error("No token provided");if(void 0===a.targetCallId)throw new Error("No target call id provided");if(void 0===a.sdp)throw new Error("No sdp provided");if(void 0===a.success)throw new Error("No success callback provided");if(void 0===a.error)throw new Error("No error callback provided");C.doOperation("transferCall",{data:{callsMediaModifications:{sdp:a.sdp}},params:{url:{sessionId:a.sessionId,type:a.breed+"s",callId:a.callId},headers:{Authorization:a.token,"x-transferTargetCallId":a.targetCallId}},success:function(){g.logInfo("transferCall: success"),a.success()},error:function(b){g.logError("transferCall: error"),g.logDebug(b),a.error(b)}})}var A,B,C,D;C=a.resourceManager,D=a.userMediaSvc,g.logDebug("RTCManager"),A=e.getAppConfiguration(),B=b.createEventManager({resourceManager:C,eventChannelType:A.eventChannelType}),this.on=f,this.off=i,this.connectSession=k,this.disconnectSession=l,this.connectCall=m,this.acceptMediaModifications=n,this.addParticipant=o,this.removeParticipant=p,this.disconnectCall=q,this.refreshSession=j,this.cancelCall=r,this.disableMediaStream=u,this.enableMediaStream=v,this.holdCall=s,this.resumeCall=t,this.rejectCall=y,this.transferCall=z,this.associateE911Id=w,this.associateToken=x}var b=ATT.private.factories,c=ATT.private.error,d=ATT.private.config.api,e=ATT.private.config.app,f=ATT.logManager.getInstance(),g=f.getLoggerByName("RTCManager"),h=ATT.utils;if(void 0===ATT.private)throw new Error("Error exporting `RTCManager`");ATT.private.RTCManager=a,ATT.private.rtcManager=function(){var c,e;return{getRTCManager:function(){return void 0===c&&(e=b.createResourceManager(d),c=new a({resourceManager:e,userMediaSvc:ATT.UserMediaService})),c}}}()}();var RTCPeerConnection=null,RTCSessionDescription,RTCIceCandidate=null,getUserMedia=null,attachMediaStream=null,reattachMediaStream=null,webrtcDetectedBrowser=null,webrtcDetectedVersion=null,createIceServer;if(navigator.mozGetUserMedia)console.log("This appears to be Firefox"),webrtcDetectedBrowser="firefox",webrtcDetectedVersion=parseInt(navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1],10),RTCPeerConnection=mozRTCPeerConnection,RTCSessionDescription=mozRTCSessionDescription,RTCIceCandidate=mozRTCIceCandidate,getUserMedia=navigator.mozGetUserMedia.bind(navigator),createIceServer=function(a,b,c){var d,e=null,f=a.split(":");return 0===f[0].indexOf("stun")?e={url:a}:0===f[0].indexOf("turn")?webrtcDetectedVersion>=27?e={url:a,credential:c,username:b}:(d=a.split("?"),0===d[1].indexOf("transport=udp")?e={url:d[0],credential:c,username:b}:null):void 0},attachMediaStream=function(a,b){console.log("Attaching media stream"),a.mozSrcObject=b,a.play()},reattachMediaStream=function(a,b){console.log("Reattaching media stream"),a.mozSrcObject=b.mozSrcObject,a.play()},MediaStream.prototype.getVideoTracks||(MediaStream.prototype.getVideoTracks=function(){return[]}),MediaStream.prototype.getAudioTracks||(MediaStream.prototype.getAudioTracks=function(){return[]});else if(navigator.webkitGetUserMedia){console.log("This appears to be Chrome"),webrtcDetectedBrowser="chrome",webrtcDetectedVersion=parseInt(navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./)[2],10);var createIceServer=function(a,b,c){var d=null,e=a.split(":");return 0===e[0].indexOf("stun")?d={url:a}:0===e[0].indexOf("turn")&&(d={url:a,credential:c,username:b}),d};RTCPeerConnection=webkitRTCPeerConnection,getUserMedia=navigator.webkitGetUserMedia.bind(navigator),attachMediaStream=function(a,b){"undefined"!==a.srcObject?a.srcObject=b:"undefined"!==a.mozSrcObject?a.mozSrcObject=b:"undefined"!==a.src?a.src=URL.createObjectURL(b):console.log("Error attaching stream to element.")},reattachMediaStream=function(a,b){a.src=b.src}}else console.log("Browser does not appear to be WebRTC-capable");!function(a){"use strict";var b,c=ATT.logManager.getInstance(),d={audio:!0,video:!0},e=c.getLoggerByName("UserMediaService");b={localMedia:null,remoteMedia:null,localStream:null,remoteStream:null,mediaConstraints:null,onUserMedia:null,onMediaEstablished:null,onUserMediaError:null,getUserMedia:function(a){e.logInfo("getUserMedia");var b=this;this.localMedia=a.localMedia,this.remoteMedia=a.remoteMedia,this.mediaConstraints=d,this.onUserMedia=a.onUserMedia,this.onMediaEstablished=a.onMediaEstablished,this.onUserMediaError=a.onUserMediaError,void 0!==a.mediaType&&(this.mediaConstraints.video="audio"!==a.mediaType),getUserMedia(this.mediaConstraints,b.getUserMediaSuccess.bind(b),function(b){e.logError(b);var c=ATT.errorDictionary.getSDKError(14e3);a.onUserMediaError(c),e.logError(c)})},getUserMediaSuccess:function(a){e.logDebug("getUserMediaSuccess"),this.showStream({localOrRemote:"local",stream:a});var b={mediaConstraints:this.mediaConstraints,localStream:a};this.onUserMedia(b)},showStream:function(a){var b;e.logTrace("showing "+a.localOrRemote+" stream...");try{"remote"===a.localOrRemote?(this.remoteStream=a.stream,b=this.remoteMedia):(this.localStream=a.stream,b=this.localMedia,b.setAttribute("muted","")),b&&(b.src=window.URL.createObjectURL(a.stream),b.play(),"remote"===a.localOrRemote&&this.onMediaEstablished())}catch(c){e.logError("showStream error"),e.logError(c),void 0!==this.onUserMediaError&&"function"==typeof this.onUserMediaError&&this.onUserMediaError(c)}},stopUserMedia:function(){e.logInfo("stopping user media streams...");try{this.localStream&&(this.localStream.stop(),this.localStream=null,this.localMedia.src=""),this.remoteStream&&(this.remoteStream.stop(),this.remoteStream=null,this.remoteMedia.src="")}catch(a){this.onUserMediaError(a)}},muteStream:function(a){if(e.logTrace("muting stream..."),this.localStream){var b,c=this.localStream.getAudioTracks(),d=c.length;for(b=0;d>b;b+=1)c[b].enabled=!1;return a.onLocalStreamMuted()}},unmuteStream:function(a){if(e.logTrace("unmuting stream..."),this.localStream){var b,c=this.localStream.getAudioTracks(),d=c.length;for(b=0;d>b;b+=1)c[b].enabled=!0;return a.onLocalStreamUnmuted()}},disableMediaStream:function(){if(this.remoteStream){var a,b,c=this.remoteStream.getVideoTracks(),d=c.length;for(a=0;d>a;a+=1)c[a].enabled=!1;for(b=this.remoteStream.getAudioTracks(),d=b.length,a=0;d>a;a+=1)b[a].enabled=!1}},enableMediaStream:function(){if(this.remoteStream){var a,b,c=this.remoteStream.getVideoTracks(),d=c.length;for(a=0;d>a;a+=1)c[a].enabled=!0;for(b=this.remoteStream.getAudioTracks(),d=b.length,a=0;d>a;a+=1)b[a].enabled=!0}}},a.UserMediaService=b}(ATT),function(){"use strict";function a(a){function c(a,b){f.setLocalDescription(a,function(){void 0!==b&&"function"==typeof b&&b(a)},function(a){k.logError("setLocalDescription: error"),k.logTrace(a),i(a)})}function d(){f.createOffer(function(a){k.logInfo("createOffer: success"),f.setLocalDescription(a,function(){k.logInfo("setLocalDescription: success")},function(a){k.logError("setLocalDescription: error"),k.logTrace(a),i(a)})},function(a){k.logError("createOffer: error"),k.logTrace(a),i(a)},{mandatory:j})}function e(a){try{f.setRemoteDescription(new RTCSessionDescription({sdp:a.remoteSdp,type:"offer"}),function(){k.logInfo("setRemoteDescription: success");try{f.createAnswer(function(b){k.logInfo("createAnswer: success"),c(b,a.onSuccess)},function(a){k.logError("createAnswer: error"),k.logTrace(a),i(a)},{mandatory:j})}catch(b){throw b}},function(a){k.logError("setRemoteDescription: error"),k.logTrace(a),i(a)})}catch(b){throw b}}var f,g,h,i,j,k=b.addLoggerForModule("PeerConnection"),l={iceServers:[{url:"STUN:74.125.133.127:19302"}]};if(k.setLevel(b.logLevel.TRACE),void 0===a||0===Object.keys(a).length)throw new Error("No options passed.");if(void 0===a.stream)throw new Error("No `stream` passed.");if(void 0===a.mediaType)throw new Error("No `mediaType` passed.");if("function"!=typeof a.onSuccess)throw new Error("No `onSuccess` callback passed.");if(g=a.onSuccess,"function"!=typeof a.onRemoteStream)throw new Error("No `onRemoteStream` callback passed.");if(h=a.onRemoteStream,"function"!=typeof a.onError)throw new Error("No `onError` callback passed.");i=a.onError,j={OfferToReceiveAudio:!0,OfferToReceiveVideo:"video"===a.mediaType};try{f=new RTCPeerConnection(l)}catch(m){throw new Error("Failed to create PeerConnection.")}return f.addStream(a.stream),f.onaddstream=function(a){h(a.stream)},void 0===a.remoteSdp&&(a.remoteSdp=null),f.onicecandidate=function(a){a.candidate?k.logInfo("Candidate: "+a.candidate):(k.logInfo("End of candidates"),g(f.localDescription))},null===a.remoteSdp?d():e({remoteSdp:a.remoteSdp}),{getLocalDescription:function(){return f.localDescription},setRemoteDescription:function(a){f.setRemoteDescription(new RTCSessionDescription(a),function(){k.logInfo("setRemoteDescription: success")},function(a){k.logError("setRemoteDescription: error"),k.logTrace(a),i(a)})},acceptSdpOffer:e,getRemoteDescription:function(){return f.remoteDescription},close:function(){f.close(),f=null}}}var b=ATT.logManager.getInstance();if(void 0===ATT.private.factories)throw new Error("Error exporting `createPeerConnection");ATT.private.factories.createPeerConnection=a}(),function(){"use strict";function a(a){function g(){var a={timestamp:new Date,mediaType:O};return void 0!==_&&(a.codec=_),P===c.CALL_TYPE.OUTGOING?a.to=M:P===c.CALL_TYPE.INCOMING&&(a.from=M),Object.keys(V).length>0&&(a.invitations=V),Object.keys(W).length>0&&(a.participants=W),a}function h(){return $}function i(a){$=a,db.publish($,g.call(this))}function j(a,b){var c,d,e,f=U.invitations();for(c in f)f.hasOwnProperty(c)&&(d=f[c],a===d.id&&(e=d.invitee,W[e]={participant:e,status:b},db.publish("invite-accepted",g())))}function k(a,b,c){V[a]={invitee:a,id:b,status:c}}function l(a,b){var c,d,e,f=U.invitations();for(c in f)f.hasOwnProperty(c)&&(d=f[c],a===d.id&&(e=d.invitee,V[e].status=b))}function m(a){return a.toString(),a.indexOf("tel")>-1?a.split("+")[1]:a.indexOf("sip")>-1?a.split(":")[1].split("@")[0]:a}function n(a){var b;fb=a.modificationId,void 0!==a.remoteSdp&&(b={sdp:a.remoteSdp},b=f.processChromeSDPOffer(b),N.acceptSdpOffer({remoteSdp:f.setupActivePassive(b.sdp),onSuccess:function(a){cb.logInfo("acceptSdpOffer: success"),eb.acceptMediaModifications({sessionId:R.sessionId,token:R.token,callId:L,breed:Q,sdp:a.sdp,modId:fb}),fb=""}}))}function o(a){cb.logDebug("onModTerminated"),"success"===a.reason&&a.remoteSdp&&-1!==a.remoteSdp.indexOf("sendonly")&&-1===a.remoteSdp.indexOf("sendrecv")&&U.setState("held"),"held"===$&&"success"===a.reason&&a.remoteSdp&&-1!==a.remoteSdp.indexOf("sendrecv")&&U.setState("resumed"),void 0!==a.remoteSdp&&N.setRemoteDescription({sdp:a.remoteSdp,type:"held"===$||"resumed"===$?"offer":"answer"}),"conference"===a.type&&void 0!==a.modificationId&&(cb.logDebug("onModTerminated:conference"),"success"===a.reason&&j(a.modificationId,"active"),"Call rejected"===a.reason&&(l(a.modificationId,"rejected"),db.publish("rejected",g()))),"success"!==a.reason&&"Call rejected"!==a.reason&&db.publish("notification",ATT.utils.extend(g(),{message:a.reason}))}function p(a){a.provisionalSdp||U.setState("connected"),void 0!==a.remoteSdp&&(U.setRemoteSdp(a.remoteSdp),N.setRemoteDescription({sdp:a.remoteSdp,type:"answer"}))}function q(){U.setState("connected"),db.publish("stream-added",{stream:Z})}function r(a){var b;void 0!==a?"Call rejected"===a.reason||bb?i("rejected"):"Call canceled"===a.reason||ab?i("canceled"):void 0!==a.reason?($="disconnected",b=g(),b.message=a.reason,db.publish("disconnected",b)):i("created"===$?"canceled":"disconnected"):i("disconnected"),eb.off(c.API_EVENT.SESSION_OPEN+":"+L,p),eb.off(c.API_EVENT.SESSION_MODIFIED+":"+L,q),eb.off(c.API_EVENT.SESSION_TERMINATED+":"+L,r),eb.off(c.API_EVENT.MODIFICATION_RECEIVED+":"+L,n),eb.off(c.API_EVENT.MODIFICATION_TERMINATED+":"+L,o),void 0!==N&&N.close()}function s(a){cb.logInfo("move"===a?"Call.move":"Call.hold");var b,c=U.localSdp();b=f.modifyForHoldCall(c),eb.holdCall({description:b,sessionId:R.sessionId,token:R.token,breed:Q,callId:L,action:a,onSuccess:function(){cb.logInfo("move"===a?"Call.move: success":"Call.hold: success")},onError:function(b){cb.logError("move"===a?"Call.move: error":"Call.hold: error"),cb.logError(b),db.publish("error",{error:b})}})}function t(){eb.on(c.API_EVENT.SESSION_OPEN+":"+L,p),eb.on(c.API_EVENT.SESSION_MODIFIED+":"+L,q),eb.on(c.API_EVENT.SESSION_TERMINATED+":"+L,r),eb.on(c.API_EVENT.MODIFICATION_RECEIVED+":"+L,n),eb.on(c.API_EVENT.MODIFICATION_TERMINATED+":"+L,o)}function u(a){L=a,i(null===L?"disconnected":"connecting")}function v(a){X=a,null!==a&&(_=f.getCodecfromSDP(a))}function w(a,b){if("connecting"!==a&&"response-pending"!==a&&"invite-accepted"!==a&&"participant-removed"!==a&&"canceled"!==a&&"rejected"!==a&&"connected"!==a&&"muted"!==a&&"unmuted"!==a&&"stream-added"!==a&&"error"!==a&&"held"!==a&&"resumed"!==a&&"disconnecting"!==a&&"disconnected"!==a&&"notification"!==a)throw new Error("Event "+a+" not defined");db.unsubscribe(a,b),db.subscribe(a,b,this)}function x(a,b){db.unsubscribe(a,b)}function y(a){Y=a}function z(a){function d(a){var b={sessionId:R.sessionId,token:R.token,description:a,breed:Q,onSuccess:function(a){c.CALL_TYPE.INCOMING===P?i("connecting"):(u(a.id),t())},onError:function(a){db.publish("error",{error:a})}};return void 0!==L&&null!==L&&(b.callId=L),"call"===Q&&(b.peer=M),ab?(ab=!1,void r({reason:"Call canceled"})):void eb.connectCall(b)}var e;try{void 0!==a&&(void 0!==a.localMedia&&(S=a.localMedia),void 0!==a.remoteMedia&&(T=a.remoteMedia)),e={mediaType:O,stream:Y,onSuccess:d,onError:function(a){db.publish("error",{error:a})},onRemoteStream:function(a){cb.logInfo("onRemoteStream"),Z=a,db.publish("stream-added",{stream:a})}},e.remoteSdp=X,N=b.createPeerConnection(e)}catch(f){db.publish("error",{error:f})}}function A(a){cb.logInfo("Call.addParticipant: ",a);try{eb.addParticipant({sessionInfo:R,invitee:a,confId:L,onSuccess:function(b){k(m(a),b,"invited"),db.publish("response-pending",g())},onError:function(a){cb.logError(a),db.publish("error",a)}})}catch(b){db.publish("error",b)}}function B(a){cb.logInfo("Call.removeParticipant: ",a);try{eb.removeParticipant({sessionInfo:R,participant:a,confId:L,onSuccess:function(){delete U.participants()[a],db.publish("participant-removed",g())},onError:function(a){cb.logError(a),db.publish("error",a)}})}catch(b){cb.logError(b),db.publish("error",b)}}function C(){if("created"===$||"connecting"===$){if(cb.logInfo("Canceling..."),i("disconnecting"),ab=!0,null===L)return;eb.cancelCall({callId:L,breed:Q,sessionId:R.sessionId,token:R.token,onSuccess:function(){cb.logInfo("cancelCall: success")},onError:function(a){cb.logError("cancelCall: error"),cb.logTrace(a),db.publish("error",{error:a})}})}else null!==L&&(cb.logInfo("Disconnecting..."),i("disconnecting"),eb.disconnectCall({sessionId:R.sessionId,breed:Q,token:R.token,callId:L,onSuccess:function(){cb.logInfo("Successfully disconnected.")},onError:function(a){cb.logError(a),db.publish("error",{error:a})}}))}function D(){cb.logInfo("Disconnecting..."),i("disconnecting"),eb.disconnectCall({sessionId:R.sessionId,token:R.token,breed:"conference",callId:L,onSuccess:function(){cb.logInfo("Successfully disconnected.")},onError:function(a){cb.logError(a),db.publish("error",{error:a})}})}function E(){try{if(this.localStream){var a,b,c;for(a=this.localStream().getAudioTracks(),c=a.length,b=0;c>b;b+=1)a[b].enabled=!1;i("muted")}}catch(d){db.publish("error",{error:d})}}function F(){try{if(this.localStream){var a,b,c;for(a=this.localStream().getAudioTracks(),c=a.length,b=0;c>b;b+=1)a[b].enabled=!0;i("unmuted")}}catch(d){db.publish("error",{error:d})}}function G(){s("hold")}function H(){s("move")}function I(){var a,b=U.localSdp();a=f.modifyForResumeCall(b),eb.resumeCall({description:a,sessionId:R.sessionId,token:R.token,callId:L,breed:Q,onSuccess:function(){cb.logInfo("resumeCall request: success")},onError:function(a){cb.logError("resumeCall request: error"),cb.logError(a),db.publish("error",{error:a})}})}function J(){bb=!0,eb.rejectCall({callId:L,sessionId:R.sessionId,token:R.token,breed:Q,onSuccess:function(){cb.logInfo("rejectCall: onSuccess")},onError:function(a){cb.logError(a),db.publish("error",a)}})}function K(a){eb.transferCall({targetCallId:a.targetCallId,transfereeSdp:a.transfereeSdp,success:function(){cb.logInfo("transfer: success"),a.success()},error:function(b){cb.logError("transfer: error"),cb.logTrace(b),a.error(b)}})}var L,M,N,O,P,Q,R,S,T,U=this,V={},W={},X=null,Y=null,Z=null,$=null,_=[],ab=!1,bb=!1,cb=e.addLoggerForModule("Call"),db=b.createEventEmitter(),eb=d.getRTCManager(),fb="";if(void 0===a||0===Object.keys(a).length)throw new Error("No input provided");if(void 0===a.breed)throw new Error("No breed provided");if("call"===a.breed&&void 0===a.peer)throw new Error("No peer provided");if(void 0===a.type)throw new Error("No type provided");if(void 0===a.mediaType)throw new Error("No mediaType provided");Q=a.breed,void 0===a.id?L=null:(L=a.id,t()),$="created",M=a.peer,O=a.mediaType,P=a.type,R=a.sessionInfo,S=a.localMedia,T=a.remoteMedia,this.peer=function(){return M},this.codec=function(){return _},this.mediaType=function(){return O},this.type=function(){return P},this.breed=function(){return Q},this.participants=function(){return W},this.invitations=function(){return V},this.sessionInfo=function(){return R},this.id=function(){return L},this.localSdp=function(){return void 0!==N?N.getLocalDescription():void 0},this.localMedia=function(){return S},this.remoteMedia=function(){return T},this.remoteSdp=function(){var a;return void 0===N?X:(a=N.getRemoteDescription(),a?a.sdp:null)},this.localStream=function(){return Y},this.remoteStream=function(){return Z},this.canceled=function(){return ab},this.rejected=function(){return bb},this.setRemoteSdp=v,this.getState=h,this.setState=i,this.setId=u,this.on=w,this.off=x,this.addStream=y,this.connect=z,this.disconnect=C,this.disconnectConference=D,this.addParticipant=A,this.removeParticipant=B,this.mute=E,this.unmute=F,this.hold=G,this.resume=I,this.move=H,this.reject=J,this.transfer=K}var b=ATT.private.factories,c=ATT.private.enum,d=ATT.private.rtcManager,e=ATT.logManager.getInstance(),f=ATT.sdpFilter.getInstance();if(void 0===ATT.rtc)throw new Error("Cannot export Call. ATT.rtc is undefined");ATT.rtc.Call=a}(),function(){"use strict";function a(){function a(a){var b,d;return null!==j.pendingCall?void g.publish("notification",{from:a.from,mediaType:a.mediaType,type:a.type,timestamp:new Date,message:"Can only handle one incoming call at a time; ignoring the second incoming call."}):Object.keys(m).length>=2?void g.publish("notification",{from:a.from,mediaType:a.mediaType,type:a.type,timestamp:new Date,message:"Two calls already in progress, unable to handle a third incoming call."}):(d=j.createCall({breed:a.type,id:a.id,peer:a.from,type:c.CALL_TYPE.INCOMING,mediaType:a.mediaType}),void(void 0!==d&&(a.sdp&&d.setRemoteSdp(a.sdp),b="call"===d.breed()?"call:incoming":"conference-invite",g.publish(b,{from:d.peer(),mediaType:d.mediaType(),codec:d.codec(),timestamp:new Date}))))}function e(a,b){g.unsubscribe(a,b)}function f(a,b){if("ready"!==a&&"connecting"!==a&&"connected"!==a&&"updating"!==a&&"needs-refresh"!==a&&"notification"!==a&&"call:incoming"!==a&&"conference-invite"!==a&&"call:switched"!==a&&"disconnecting"!==a&&"disconnected"!==a&&"address-updated"!==a&&"all-calls-terminated"!==a&&"error"!==a)throw new Error("Event "+a+" not defined");g.unsubscribe(a,b),g.subscribe(a,b,this)}var g,h,i,j=this,k=null,l=null,m={};i=d.getLoggerByName("Session"),g=b.createEventEmitter(),h=ATT.private.rtcManager.getRTCManager(),this.timeout=null,this.e911Id=null,this.pendingCall=null,this.currentCall=null,this.timer=null,this.on=f.bind(this),this.off=e.bind(this),this.getToken=function(){return l},this.getId=function(){return k},this.setId=function(a){return k=a,null===a?void g.publish("disconnected"):void g.publish("connected")},this.update=function(a){if(void 0===a)throw new Error("No options provided");if(void 0!==a.timeout&&"number"!=typeof a.timeout)throw new Error("Timeout is not a number.");g.publish("updating",a),l=a.token||l,this.e911Id=a.e911Id||this.e911Id,void 0!==a.timeout&&(this.timeout=a.timeout<6e4?a.timeout:a.timeout-6e4,null!==this.timer&&clearInterval(this.timer),this.timer=setInterval(function(){g.publish("needs-refresh"),h.refreshSession({sessionId:k,token:l,success:function(){},error:function(a){g.publish("error",{error:a})}})},this.timeout))},this.connect=function(b){try{if(void 0===b)throw ATT.errorDictionary.getSDKError("2002");if(void 0===b.token)throw ATT.errorDictionary.getSDKError("2001");try{i.logDebug("Session.connect"),l=b.token,this.e911Id=b.e911Id,g.publish("connecting"),j=this,h.connectSession({token:b.token,e911Id:b.e911Id,onSessionConnected:function(a){try{i.logDebug("connectSession.onSessionConnected"),j.setId(a.sessionId),j.update({timeout:a.timeout})}catch(b){i.logError(b),g.publish("error",{error:ATT.errorDictionary.getSDKError("2004")})}},onSessionReady:function(b){g.publish("ready",b),h.on("invitation-received:"+k,a)},onError:function(a){g.publish("error",{error:a})}})}catch(c){throw ATT.errorDictionary.getSDKError("2004")}}catch(c){i.logError(c),g.publish("error",{error:c})}},this.disconnect=function(){try{g.publish("disconnecting"),clearInterval(this.timer),h.disconnectSession({sessionId:j.getId(),token:j.getToken(),e911Id:j.e911Id,onSessionDisconnected:function(){try{j.setId(null)}catch(a){g.publish("error",{error:a})}},onError:function(a){g.publish("error",{error:a})}})}catch(a){g.publish("error",{error:a})}},this.addCall=function(a){i.logInfo("session:addCall"),m[a.id()]=a},this.createCall=function(a){var b=new ATT.rtc.Call(ATT.utils.extend(a,{sessionInfo:{sessionId:this.getId(),token:l}}));return b.on("connected",function(){null!==j.currentCall&&g.publish("call:switched",{from:j.currentCall.peer(),to:j.pendingCall.peer(),timestamp:new Date}),j.currentCall=j.pendingCall,j.pendingCall=null,j.addCall(j.currentCall)}),b.on("error",function(){b===j.pendingCall&&(j.pendingCall=null)
}),this.pendingCall=b,b},this.getCall=function(a){return m[a]},this.getCalls=function(){return m},this.switchTo=function(a){if(void 0===a||void 0===m[a])throw new Error("You must pass a valid call id");g.publish("call:switched",{from:this.currentCall.peer(),to:m[a].peer(),timestamp:new Date}),this.currentCall=m[a]},this.terminateCalls=function(){var a;for(a in m)m.hasOwnProperty(a)&&m[a].disconnect()},this.deleteCall=function(a){if(void 0===m[a])throw new Error("Call not found");delete m[a],0===Object.keys(m).length&&g.publish("all-calls-terminated")},this.deletePendingCall=function(){this.pendingCall=null},this.deleteCurrentCall=function(){this.currentCall&&(this.deleteCall(this.currentCall.id()),this.currentCall=null)},this.associateE911Id=function(a){ATT.utils.extend(a,{sessionId:this.getId(),token:this.getToken(),onSuccess:function(){g.publish("address-updated")},onError:function(a){g.publish("error",{error:a})}}),h.associateE911Id(a)}}var b=ATT.private.factories,c=ATT.private.enum,d=ATT.logManager.getInstance();if(void 0===ATT.rtc)throw new Error("Cannot export Session. ATT.rtc is undefined");ATT.rtc.Session=a}(),function(){"use strict";function a(a){var b,c,d=!0;if(c={first_name:!0,last_name:!0,house_number:!0,street:!0,unit:!1,city:!0,state:!0,zip:!0,is_confirmed:!0},"object"!=typeof a)return!1;if(0===Object.keys(a).length)return!1;for(b in c)if(c.hasOwnProperty(b)){if(c[b]&&void 0===a[b])return!1;if(c[b]&&0===a[b].length)return!1}return d}function b(a){if(void 0===a||0===Object.keys(a).length)throw new Error("No options provided");if(void 0===a.app_scope)throw new Error("No scope provided");if("MOBILE_NUMBER"!==a.app_scope&&"ACCOUNT_ID"!==a.app_scope&&"VIRTUAL_NUMBER"!==a.app_scope&&"E911"!==a.app_scope)throw new Error("Invalid scope provided");if("MOBILE_NUMBER"===a.app_scope&&void 0===a.auth_code)throw new Error("No auth_code provided");var b,c=ATT.private.config.app.getAppConfiguration(),d=c.dhs_https_url;b=new ATT.RESTClient({method:"POST",url:d+"/tokens",data:{app_scope:a.app_scope,auth_code:a.auth_code},success:function(b){e.logInfo("POST /tokens:success"),a.success(b.getJson())},error:function(b){e.logError("POST /tokens:error"),e.logTrace(b.getJson()),a.error(b.getJson())}}),b.ajax()}function c(b){if(void 0===b||0===Object.keys(b).length)throw new Error("No options provided");if(void 0===b.token)throw new Error("No token provided");if(void 0===b.address)throw new Error("No address provided");if(!a(b.address))throw new Error("Invalid address provided");var c,d,f=ATT.private.config.app.getAppConfiguration(),g=f.dhs_https_url;c=b.address,c.access_token=b.token,d=new ATT.RESTClient({method:"POST",url:g+"/e911ids",data:c,success:function(a){e.logInfo("POST /e911ids: success"),b.success(a.getJson())},error:function(a){e.logError("POST /e911ids: error"),e.logTrace(a.getJson()),b.error(a.getJson())}}),d.ajax()}var d=ATT.logManager.getInstance(),e=d.getLoggerByName("rtc.dhs");if(void 0===ATT.rtc)throw new Error("Error exporting ATT.rtc.dhs");ATT.rtc.dhs={createAccessToken:b,createE911Id:c}}(),function(){"use strict";function a(){function a(a,b){var c,d;for(c={mute:["connected","resumed","unmuted"],unmute:["resumed","muted"],resume:["held"],hold:["connected","resumed","muted","unmuted"]},d=0;d<c[a].length;d+=1)if(b===c[a][d])return!0;return!1}function e(a,b){var c,d;return V.logInfo("call disconnected event by phone layer"),R.publish("call:disconnected",b),S.currentCall&&a.id()===S.currentCall.id()?(S.deleteCurrentCall(),c=S.getCalls(),i(),d=Object.keys(c),void(d.length>0&&(S.currentCall=c[d[0]],"held"===S.currentCall.getState()&&S.currentCall.autoresume&&S.currentCall.resume()))):S.pendingCall&&a.id()===S.pendingCall.id()?(S.deletePendingCall(),void i()):void S.deleteCall(a.id())}function f(a){R.publish("session:ready",a)}function g(a){R.publish("session:disconnected",a),U.stopUserMedia(),S.off("ready",f),S.off("disconnected",g),S=void 0}function h(a){return T.getSDKError(a)}function i(){0===Object.keys(S.getCalls()).length&&U.stopUserMedia()}function j(a,b){var c=h(a),d={};d.error=void 0===c?"TODO: Error not in dictionary":c,void 0!==b&&(d.data=JSON.stringify(b)),V.logError(JSON.stringify(d)),R.publish("error",d)}function k(a){try{return ATT.phoneNumber.cleanPhoneNumber(a)}catch(b){V.logError(b),R.publish("error",{error:b})}}function l(a){try{return ATT.phoneNumber.formatNumber(a)}catch(b){V.logError(b),R.publish("error",{error:b})}}function m(a,b,c){b.on("stream-added",function(a){U.showStream({stream:a.stream,localOrRemote:"remote"})}),void 0===a.mediaType&&(a.mediaType=b.mediaType()),U.getUserMedia({mediaType:a.mediaType,localMedia:a.localMedia,remoteMedia:a.remoteMedia,onUserMedia:function(a){try{V.logDebug("getUserMedia: onUserMedia"),b.addStream(a.localStream),b.connect()}catch(d){V.logError(d),void 0!==c&&"function"==typeof c&&c(d)}},onMediaEstablished:function(){return V.logDebug("getUserMedia: onMediaEstablished"),null!==S.pendingCall&&"connecting"===S.pendingCall.getState()&&"call"===S.pendingCall.breed()?void R.publish("call:ringback-provided",{}):void(null!==S.currentCall&&"connected"===S.currentCall.getState()&&(V.logDebug("media:established"),R.publish("media:established",{id:b.id,from:b.peer(),timestamp:new Date,mediaType:b.mediaType(),codec:b.codec()})))},onUserMediaError:function(a){V.logDebug("getUserMedia: onUserMediaError"),j("13005",a)}})}function n(){return S}function o(a,b){if("session:ready"!==a&&"session:disconnected"!==a&&"session:call-switched"!==a&&"notification"!==a&&"dialing"!==a&&"answering"!==a&&"call:incoming"!==a&&"call:connecting"!==a&&"call:connected"!==a&&"call:disconnecting"!==a&&"call:disconnected"!==a&&"call:muted"!==a&&"call:unmuted"!==a&&"call:held"!==a&&"call:resumed"!==a&&"call:canceled"!==a&&"call:rejected"!==a&&"address-updated"!==a&&"call:ringback-provided"!==a&&"media:established"!==a&&"conference:invitation-received"!==a&&"conference:joining"!==a&&"conference:invitation-sending"!==a&&"conference:invitation-rejected"!==a&&"conference:connecting"!==a&&"conference:invitation-sent"!==a&&"conference:invitation-accepted"!==a&&"conference:participant-removed"!==a&&"conference:held"!==a&&"conference:resumed"!==a&&"conference:disconnecting"!==a&&"conference:ended"!==a&&"conference:connected"!==a&&"warning"!==a&&"error"!==a)throw new Error("Event "+a+" not defined");R.unsubscribe(a,b),R.subscribe(a,b,this)}function p(){var a,b,d,e,f=S.getCalls(),g=[];for(a in f)if(f.hasOwnProperty(a)){if(b={state:f[a].getState(),type:f[a].breed(),isIncoming:f[a].type()===c.CALL_TYPE.INCOMING},f[a].type()===c.CALL_TYPE.INCOMING){b.participants=[],e=f[a].participants();for(d in e)e.hasOwnProperty(d)&&b.participants.push({id:"john@domain.com",status:"invitation-sent"})}else f[a].type()===c.CALL_TYPE.OUTGOING&&(b.peer=f[a].peer());g.push(b)}return g}function q(a){try{if(void 0===a)return void j("2002");if(void 0===a.token)return void j("2001");if(void 0!==S&&null!==S.getId())return void j("2005");try{V.logDebug("Phone.login"),void 0===S&&(S=new ATT.rtc.Session),S.connect(a),S.on("ready",f)}catch(b){return V.logError(b),void j("2004")}}catch(b){V.logError(b),R.publish("error",{error:b})}}function r(){try{if(null===S||null===S.getId())return void j("3001");try{V.logDebug("Phone.logout"),S.on("disconnected",g),S.disconnect()}catch(a){return V.logError(a),void j("3000")}}catch(a){V.logError(a),R.publish("error",{error:a})}}function s(a){var b;try{if(null===S.getId())return void j("4004");if(void 0===a)return void j("4009");if(void 0===a.localMedia||"VIDEO"!==a.localMedia.tagName&&"AUDIO"!==a.localMedia.tagName)return void j("4006");if(void 0===a.remoteMedia||"VIDEO"!==a.remoteMedia.tagName&&"AUDIO"!==a.remoteMedia.tagName)return void j("4007");if(void 0===a.destination)return void j("4008");if(void 0!==a.mediaType&&"audio"!==a.mediaType&&"video"!==a.mediaType)return void j("4002");if(a.destination.indexOf("sip:")>-1||a.destination.indexOf("tel:")>-1)return void j("4000");if(-1===a.destination.indexOf("@")){if(a.destination=k(a.destination),!1===a.destination)return void j("4000")}else if(a.destination.split("@").length>2)return void j("4001");try{V.logDebug("Phone.dial"),R.publish("dialing",{to:a.destination,mediaType:a.mediaType,timestamp:new Date}),b=S.createCall({peer:a.destination,breed:"call",type:c.CALL_TYPE.OUTGOING,mediaType:a.mediaType,localMedia:a.localMedia,remoteMedia:a.remoteMedia}),b.on("connecting",function(a){R.publish("call:connecting",a)}),b.on("rejected",function(a){R.publish("call:rejected",a),S.deletePendingCall(),i()}),b.on("connected",function(a){R.publish("call:connected",a)}),b.on("held",function(a){V.logInfo("call held event by phone layer"),R.publish("call:held",a)}),b.on("resumed",function(a){V.logInfo("call resumed by phone layer"),R.publish("call:resumed",a)}),b.on("disconnected",function(a){e(b,a)}),b.on("notification",function(a){V.logInfo("notification event by phone layer"),R.publish("notification",a),S.deletePendingCall(),i()}),b.on("error",function(a){V.logError(a),R.publish("error",a)}),m(a,b,function(a){V.logError(a),R.publish("error",{error:ATT.errorDictionary.getSDKError("4003"),data:a})})}catch(d){return V.logError(d),void j("4003")}}catch(d){V.logError(d),R.publish("error",{error:d})}}function t(a){function b(){V.logInfo("phone:dialSecondCall"),c.off("held",b),s(a)}V.logInfo("addCall");var c;if(2<=p().length)return void j("27010");try{if(void 0===a)return void j("27001");if(void 0===a.localMedia||"VIDEO"!==a.localMedia.tagName&&"AUDIO"!==a.localMedia.tagName)return void j("27002");if(void 0===a.remoteMedia||"VIDEO"!==a.remoteMedia.tagName&&"AUDIO"!==a.remoteMedia.tagName)return void j("27003");if(void 0===a.destination)return void j("27004");if(-1===a.destination.indexOf("@")){if(a.destination=k(a.destination),!1===a.destination)return void j("27005")}else if(a.destination.split("@").length>2)return void j("27006");if(void 0!==a.mediaType&&"audio"!==a.mediaType&&"video"!==a.mediaType)return void j("27007");if(null===S.getId())return void j("27008");if(null===S.currentCall)return void j("27009");try{c=S.currentCall,c.on("held",b),c.hold(),c.autoresume=!0}catch(d){return V.logError("Error while trying to hold call"),void j("27000",d)}}catch(d){V.logError("addCall:error"),V.logError(d),R.publish("error",{error:d})}}function u(a,b){R.publish("answering",{from:a.peer(),mediaType:a.mediaType(),codec:a.codec(),timestamp:new Date}),a.on("connecting",function(a){R.publish("call:connecting",a)}),a.on("connected",function(a){R.publish("call:connected",a)}),a.on("held",function(a){R.publish("call:held",a)}),a.on("resumed",function(a){R.publish("call:resumed",a)}),a.on("disconnected",function(b){e(a,b)}),a.on("notification",function(a){R.publish("notification",a),S.deleteCurrentCall(),i()}),a.on("error",function(a){j("5002",a)}),m(b,a)}function v(a){function b(){c="end"===a.action?"disconnected":"held",e.off(c,b),u(d,a)}var c,d,e;try{if(void 0===a)return void j("5004");if(void 0===a.localMedia||"VIDEO"!==a.localMedia.tagName&&"AUDIO"!==a.localMedia.tagName)return void j("5001");if(void 0===a.remoteMedia||"VIDEO"!==a.remoteMedia.tagName&&"AUDIO"!==a.remoteMedia.tagName)return void j("5001");if(null===S.getId())return void j("5003");if(d=S.pendingCall,null===d)return void j("5000");if(void 0!==a.action&&"hold"!==a.action&&"end"!==a.action)return void j("5005");if(V.logInfo("Answering ... "),e=S.currentCall,null!==e){if(void 0===a.action)return void j("5005");if("hold"===a.action){if("held"!==e.getState())return e.on("held",b),e.hold(),void(e.autoresume=!0);b(d,a,!0)}return void("end"===a.action&&(e.on("disconnected",b),e.disconnect()))}u(d,a)}catch(f){return V.logError(f),void j("5002",f)}}function w(a){V.logInfo("startConference");var b;try{if(void 0===a||0===Object.keys(a).length)return V.logError(" parameters not found"),void j("18000");if(void 0===S||null===S.getId())return V.logError("no session to start  conference"),void j("18007");if(null!==S.currentCall&&"conference"===S.currentCall.breed())return V.logError("Please End your current Conference"),void j("18006");if(void 0===a.localMedia||"VIDEO"!==a.localMedia.tagName&&"AUDIO"!==a.localMedia.tagName)return V.logError("localMedia not passed"),void j("18001");if(void 0===a.remoteMedia||"VIDEO"!==a.remoteMedia.tagName&&"AUDIO"!==a.remoteMedia.tagName)return V.logError("remoteMedia not passed"),void j("18002");if(void 0===a.mediaType||"audio"!==a.mediaType&&"video"!==a.mediaType)return V.logError("mediaType not passed"),void j("18003");a.breed="conference",a.type=c.CALL_TYPE.OUTGOING,b=S.createCall(a),b.on("error",function(a){V.logError(a),R.publish("error",a)}),b.on("connected",function(a){V.logInfo("connected conference event published to UI"),R.publish("conference:connected",a)}),b.on("resumed",function(a){V.logInfo("conference resumed by phone layer"),R.publish("conference:resumed",a)}),b.on("held",function(a){V.logInfo("held conference event published to UI"),R.publish("conference:held",a)}),b.on("response-pending",function(a){R.publish("conference:invitation-sent",a)}),b.on("invite-accepted",function(a){R.publish("conference:invitation-accepted",a)}),b.on("rejected",function(a){R.publish("conference:invitation-rejected",a)}),b.on("notification",function(a){R.publish("notification",a)}),b.on("participant-removed",function(a){R.publish("conference:participant-removed",a)}),b.on("disconnected",function(a){V.logInfo("conference ended  event by phone layer"),R.publish("conference:ended",a),S.deleteCurrentCall(),i()}),m(a,b)}catch(d){return void j("18005",d)}}function x(a){try{if(null===S||null===S.getId())return void j("20001");if(null===S.pendingCall)return void j("20002");try{V.logDebug("Phone.joinConference");var b=S.pendingCall;R.publish("conference:joining",{from:b.peer(),mediaType:b.mediaType(),codec:b.codec(),timestamp:new Date}),b.on("error",function(a){V.logError(a),R.publish("error",a)}),b.on("connecting",function(a){V.logInfo("conference connecting event by phone layer"),R.publish("conference:connecting",a)}),b.on("connected",function(a){V.logInfo("conference connected event by phone layer"),R.publish("conference:connected",a)}),b.on("held",function(a){V.logInfo("conference held event by phone layer"),R.publish("conference:held",a)}),b.on("resumed",function(a){V.logInfo("conference resumed event by phone layer"),R.publish("conference:resumed",a)}),b.on("disconnected",function(a){V.logInfo("conference ended event by phone layer"),R.publish("conference:ended",a),S.deleteCurrentCall(),i()}),b.on("notification",function(a){V.logInfo("Notification event by phone layer"),R.publish("notification",a),S.deleteCurrentCall(),i()}),m(a,b,function(a){V.logError(a),R.publish("error",{error:ATT.errorDictionary.getSDKError("20000"),data:a})})}catch(c){return V.logError(c),void j("20000")}}catch(c){V.logError(c),R.publish("error",{error:c})}}function y(){try{var b=S.currentCall;if(null===b||null===b.id)return void j("9000");try{V.logDebug("Phone.mute"),b.on("muted",function(a){R.publish("call:muted",a)}),"muted"===b.getState()?R.publish("warning",{message:"Already muted"}):a("mute",b.getState())&&b.mute()}catch(c){return V.logError(c),void j("9001")}}catch(c){V.logError(c),R.publish("error",{error:c})}}function z(){try{var b=S.currentCall;if(null===b||null===b.id)return void j("10000");try{V.logDebug("Phone.unmute"),b.on("unmuted",function(a){R.publish("call:unmuted",a)}),"unmuted"===b.getState()?R.publish("warning",{message:"Already unmuted"}):a("unmute",b.getState())&&b.unmute()}catch(c){return V.logError(c),void j("10001")}}catch(c){V.logError(c),R.publish("error",{error:c})}}function A(){var a=S.currentCall;return a?a.mediaType():null}function B(){var a=S.currentCall;return null!==a}function C(){var a;try{if(a=S.currentCall,null===a||null===a.id())return void j("6000");try{a.on("disconnecting",function(a){R.publish("call:disconnecting",a)}),a.disconnect()}catch(b){return V.logError(b),void j("6001")}}catch(b){V.logError(b),R.publish("error",{error:b})}}function D(){var a=S.pendingCall;try{if(null===a)return void j("11000");try{a.on("canceled",function(a){R.publish("call:canceled",a),S.deletePendingCall(),i()}),a.disconnect()}catch(b){return V.logError(b),void j("11001")}}catch(b){V.logError(b),R.publish("error",{error:b})}}function E(){try{var a=S.pendingCall;if(null===a||null===a.id())return void j("12000");try{a.on("rejected",function(a){R.publish("call:rejected",a),S.deletePendingCall(),i()}),a.reject()}catch(b){return V.logError(b),void j("12001")}}catch(b){V.logError(b),R.publish("error",{error:b})}}function F(){try{if(null===S||null===S.getId())return void j("22001");if(null===S.pendingCall)return void j("22002");try{V.logDebug("Phone.rejectConference");var a=S.pendingCall;a.reject()}catch(b){return V.logError(b),void j("22000")}}catch(b){V.logError(b),R.publish("error",{error:b})}}function G(){var b;try{if(b=S.currentCall,null===b||null===b.id())return void j("7000");if("held"===b.getState())return V.logWarning("Call is already on hold"),void R.publish("warning",{message:"Call is already on hold",timestamp:new Date});try{a("hold",b.getState())&&b.hold()}catch(c){return V.logError(c),void j("7001")}}catch(c){V.logError(c),R.publish("error",{error:c})}}function H(){var b;try{if(b=S.currentCall,null===b||null===b.id())return void j("8000");if(!a("resume",b.getState()))return void j("8001");try{b.resume()}catch(c){return V.logError(c),void j("8002")}}catch(c){V.logError(c),R.publish("error",{error:c})}}function I(){var a;try{if(null===S||null===S.getId())return void j("28000");if(a=S.currentCall,null===a||null===a.id())return void j("28001");try{V.logDebug("Phone.move"),a.move()}catch(b){return V.logError(b),void j("28002")}}catch(b){V.logError(b),R.publish("error",{error:b})}}function J(){function a(){var c,d,e;b.off("held",a),d=S.getCalls();for(c in d)if(d.hasOwnProperty(c)&&c!==b.id()){e=c;break}S.switchTo(e),b=S.currentCall,"held"===b.getState()&&b.autoresume&&(b.resume(),b.autoresume=!1)}var b=S.currentCall;try{if(null===S||null===S.getId())return void j(30001);if(null===S.currentCall||null===S.currentCall.id())return void j(30002);if(2>Object.keys(S.getCalls()).length)return void j(30003);if("held"!==b.getState())return b.on("held",a),b.hold(),void(b.autoresume=!0);a()}catch(c){return void j(3e4)}}function K(){var a;try{if(null===S||null===S.getId())return void j("29001");if(a=S.currentCall,null===a||null===a.id())return void j("29002");try{V.logDebug("Phone.transfer")}catch(b){return V.logError(b),void j("29000",b)}}catch(b){V.logError(b),R.publish("error",{error:b})}}function L(a){try{if(void 0===a)return void j("17000");if(void 0===S||null===S.getId())return void j("17002");if(void 0===a.e911Id||null===a.e911Id)return void j("17000");try{S.on("address-updated",function(){R.publish("address-updated")}),S.associateE911Id(a)}catch(b){return V.logError(b),void j("17001")}}catch(b){V.logError(b),R.publish("error",{error:b})}}function M(a){try{if(V.logDebug("Phone.addParticipant"),void 0===a)return void j("19000");try{this.addParticipants([a])}catch(b){return void j("19001",b)}}catch(b){V.logError(b),R.publish("error",{error:b})}}function N(a){var b,c,d,e,f;try{if(V.logDebug("Phone.addParticipants"),void 0===a)return V.logError("Parameter missing"),void j("24000");if("object"!=typeof a||null===a||0===Object.keys(a).length)return void j("24001");if(null===S.getId())return void j("24002");if(b=S.currentCall,"conference"!==b.breed())return V.logError("Conference not initiated "),void j("24003");for(f=b.participants(),c=0;c<a.length;c+=1){if(d=a[c],d.indexOf("sip:")>-1||d.indexOf("tel:")>-1)return void j("24007");if(-1===d.indexOf("@")){if(d=k(d),!1===d)return void j("24006")}else if(d.split("@").length>2)return void j("24007");a[c]=d}try{for(c=0;c<a.length;c+=1)if(d=a[c],0===Object.keys(f).length)R.publish("conference:invitation-sending",{invitee:d,timestamp:new Date}),b.addParticipant(d);else for(e in f)if(f.hasOwnProperty(e))if(d!==e)R.publish("conference:invitation-sending",{invitee:d,timestamp:new Date}),b.addParticipant(d);else if(d===e)return void j("24005",{invitee:d,timestamp:new Date})}catch(g){return void j("24004",g)}}catch(g){V.logError(g),R.publish("error",{error:g})}}function O(){V.logDebug("Phone.endConference");var a;try{if(null===S.getId())return void j("23001");if(a=S.currentCall,null===a||"conference"!==a.breed())return void j("23002");a.on("disconnecting",function(a){R.publish("conference:disconnecting",a)});try{a.disconnectConference()}catch(b){return void j("23000",b)}}catch(b){V.logError(b),R.publish("error",{error:b})}}function P(){V.logDebug("Phone.getParticipant");var a,b;try{if(null===S.getId())return void j("21002");if(a=S.currentCall,null===a||"conference"!==a.breed())return void j("21000");try{return b=a.participants()}catch(c){return void j("21001",c)}}catch(c){V.logError(c),R.publish("error",{error:c})}}function Q(a){var b;try{if(V.logDebug("Phone.removeParticipant"),null===S.getId())return void j("25000");if(b=S.currentCall,null===b||"conference"!==b.breed())return void j("25001");if(void 0===a)return void j("25002");try{b.removeParticipant(a)}catch(c){return V.logError(c),void j("25003")}}catch(c){V.logError(c),R.publish("error",{error:c})}}var R=b.createEventEmitter(),S=new ATT.rtc.Session,T=ATT.errorDictionary,U=ATT.UserMediaService,V=d.addLoggerForModule("Phone");V.logInfo("Creating new instance of Phone"),S.on("call:incoming",function(a){function b(c){null!==S.pendingCall&&c.id()===S.pendingCall.id()&&(R.publish("call:canceled",a),c.off("canceled",b),S.deletePendingCall(),i())}function c(b){null!==S.pendingCall&&b.id()===S.pendingCall.id()&&(R.publish("call:disconnected",a),b.off("disconnected",c),S.deletePendingCall(),i())}V.logInfo("call incoming event  by phone layer"),R.publish("call:incoming",a),S.pendingCall&&(S.pendingCall.on("canceled",b.bind(null,S.pendingCall)),S.pendingCall.on("disconnected",c.bind(null,S.pendingCall)))}),S.on("call:switched",function(a){V.logInfo("call:switched event from session"),R.publish("session:call-switched",a)}),S.on("notification",function(a){V.logInfo("notification event from session"),R.publish("notification",a)}),S.on("conference-invite",function(a){V.logInfo("conference:invitation-received event by phone layer"),R.publish("conference:invitation-received",a)}),S.on("error",function(a){V.logError("Error in Session"),V.logTrace(a),R.publish("error",a)}),this.on=o,this.getSession=n,this.login=q,this.logout=r,this.dial=s,this.addCall=t,this.answer=v,this.mute=y,this.unmute=z,this.hangup=C,this.hold=G,this.resume=H,this.move=I,this.switchCall=J,this.transfer=K,this.cancel=D,this.reject=E,this.associateE911Id=L,this.startConference=w,this.endConference=O,this.joinConference=x,this.rejectConference=F,this.addParticipant=M,this.addParticipants=N,this.getParticipants=P,this.removeParticipant=Q,this.getCalls=p,this.getMediaType=A,this.isCallInProgress=B,this.cleanPhoneNumber=k,this.formatNumber=l}var b=ATT.private.factories,c=ATT.private.enum,d=ATT.logManager.getInstance();if(void 0===ATT.private)throw new Error("Error exporting ATT.private.Phone.");if(ATT.private.Phone=a,void 0===ATT.rtc)throw new Error("Error exporting ATT.rtc.Phone.");ATT.rtc.Phone=function(){var a,b=d.addLoggerForModule("rtc");return{getPhone:function(){return void 0===a&&(b.logInfo("Creating new Phone instance"),a=new ATT.private.Phone),a}}}()}(),function(){"use strict";var a,b=ATT.logManager.getInstance();return a=b.getLogger("ATTMain"),void 0===window.ATT?void a.logTrace("ATT is not defined."):void 0===ATT.utils.createErrorDictionary?void a.logTrace("ATT doesn't have a method to create an error dictionary."):(ATT.errorDictionary=ATT.utils.createErrorDictionary(ATT.utils.ErrorStore.SDKErrors.getAllSDKErrors(),ATT.utils.ErrorStore.APIErrors.getAllAPIErrors()),void 0!==ATT.errorDictionary&&a.logTrace("Error Dictionary created."),void a.logTrace("SDK Errors loaded into the Dictionary."))}();